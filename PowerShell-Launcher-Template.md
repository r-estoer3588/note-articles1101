# PowerShellランチャー構築プロンプトテンプレート

## 🎯 基本テンプレート

```
以下の要件でPowerShellランチャースクリプトを作成してください：

【ツール名】: [ツール名]
【スクリプトパス】: [実行したいスクリプトのパス]
【機能】:
- ヘルプ表示（-Help）
- 初回セットアップ（-Setup）
- [その他のオプション]

【要件】:
1. どのディレクトリからでも実行可能にする
2. エラー時に次のステップを明示
3. 依存関係の自動チェック
4. カラフルな出力（絵文字使用）
5. PowerShellプロファイルへの自動追加機能
6. 短縮エイリアスの設定

【追加要件】:
- [あれば追加の要件を記載]
```

---

## 📝 実践例：今回の教育ツール

```
以下の要件でPowerShellランチャースクリプトを作成してください：

【ツール名】: 教育カテゴリ別投稿生成ツール
【スクリプトパス】: tools\education_prompt_manager.py
【機能】:
- ヘルプ表示（-Help）
- 初回セットアップ（-Setup）: pip install, API設定ガイド
- カテゴリ一覧表示（-List）

【要件】:
1. どのディレクトリからでも実行可能にする
   - エイリアス: education, edu
2. エラー時に次のステップを明示
   - Pythonなし → インストールガイド
   - 依存パッケージなし → セットアップ提案
3. 依存関係の自動チェック
   - Python存在確認
   - openai, pyperclip パッケージ確認
4. カラフルな出力（絵文字使用）
5. PowerShellプロファイルへの自動追加
   - Push-Location/Pop-Location で元のディレクトリに戻る
   - 起動時メッセージ表示
6. 短縮エイリアス: edu

【追加要件】:
- API未設定時にGitHub Copilot Chat統合モードを推奨
- セットアップで対話的にAPI設定を促す
```

---

## 📝 実践例2：自動学習ツール

```
以下の要件でPowerShellランチャースクリプトを作成してください：

【ツール名】: 自動学習ループツール
【スクリプトパス】: tools\learning_manager.py
【機能】:
- ヘルプ表示（-Help）
- 初回セットアップ（-Setup）
- 指標収集（-Ingest）: X/note/Threads API統合
- 前回検証（-Review）: KPIダッシュボード表示
- 成功例再生（-Replay）: 過去3件の高成果投稿を参照

【要件】:
1. どのディレクトリからでも実行可能にする
   - エイリアス: learning, le
2. エラー時に次のステップを明示
   - API未接続 → 各チャネル接続ガイド
   - データ不足 → 最低収集期間の提示
3. 依存関係の自動チェック
   - pandas, matplotlib（グラフ生成）
   - requests（API呼び出し）
4. カラフルな出力（絵文字使用）
   - 成功率の色分け表示（緑/黄/赤）
5. PowerShellプロファイルへの自動追加
   - Push-Location/Pop-Location で元のディレクトリに戻る
6. 短縮エイリアス: le

【追加要件】:
- `-Goal "noteリード10件" -Deliverable "2600文字記事"` のようなCLIオプション
- 改善指示を `learning/prompts/{date}.md` に自動保存
- 前回比±10%以上の変動を強調表示
```

---

## 🔧 応用例1: データベースバックアップツール

```
以下の要件でPowerShellランチャースクリプトを作成してください：

【ツール名】: DBバックアップツール
【スクリプトパス】: scripts\backup_database.py
【機能】:
- ヘルプ表示（-Help）
- バックアップ実行（引数なし）
- リストア（-Restore）
- バックアップ一覧（-List）
- 自動実行設定（-Schedule）

【要件】:
1. どのディレクトリからでも実行可能
   - エイリアス: backup, bk
2. エラー時に次のステップを明示
   - DB接続失敗時の診断
3. 依存関係の自動チェック
   - psycopg2, mysql-connector など
4. カラフルな出力
   - 成功: 緑、警告: 黄、エラー: 赤
5. PowerShellプロファイルへの自動追加
6. タスクスケジューラ登録機能

【追加要件】:
- バックアップ成功時に通知
- ログファイル自動ローテーション
```

---

## 🔧 応用例2: テスト実行ツール

```
以下の要件でPowerShellランチャースクリプトを作成してください：

【ツール名】: テスト実行ツール
【スクリプトパス】: pytest または python -m pytest
【機能】:
- ヘルプ表示（-Help）
- 全テスト実行（引数なし）
- 特定テスト実行（-Test [パス]）
- カバレッジレポート（-Coverage）
- ウォッチモード（-Watch）

【要件】:
1. どのディレクトリからでも実行可能
   - エイリアス: test, t
2. エラー時に次のステップを明示
   - テスト失敗時の詳細表示
3. 依存関係の自動チェック
   - pytest, pytest-cov
4. カラフルな出力
   - 成功率の進捗バー
5. PowerShellプロファイルへの自動追加
6. 最後のテスト結果をキャッシュ

【追加要件】:
- VSCodeのテストエクスプローラー連携
- 失敗したテストのみ再実行（-Failed）
```

---

## 🔧 応用例3: ログ解析ツール

```
以下の要件でPowerShellランチャースクリプトを作成してください：

【ツール名】: ログ解析ツール
【スクリプトパス】: tools\analyze_logs.py
【機能】:
- ヘルプ表示（-Help）
- 最新ログ解析（引数なし）
- 特定期間解析（-From [日付] -To [日付]）
- エラー抽出（-Errors）
- レポート生成（-Report）

【要件】:
1. どのディレクトリからでも実行可能
   - エイリアス: logs, lg
2. エラー時に次のステップを明示
3. 依存関係の自動チェック
   - pandas, matplotlib
4. カラフルな出力
   - エラー数を赤で強調
5. PowerShellプロファイルへの自動追加
6. レポートを自動でブラウザで開く

【追加要件】:
- リアルタイムtail機能（-Tail）
- Slackに通知（-Notify）
```

---

## 📋 共通パターン（コピペ用）

### 基本構造
```powershell
param(
    [switch]$Help,
    [switch]$Setup,
    [switch]$List  # オプション
)

$ErrorActionPreference = "Stop"

# カラー出力関数
function Write-Header { ... }
function Write-Success { ... }
function Write-Warning-Custom { ... }
function Write-Info { ... }

# ヘルプ処理
if ($Help) { ... }

# セットアップ処理
if ($Setup) { ... }

# 環境チェック
# - 実行ファイル存在確認
# - 依存関係確認
# - 設定ファイル確認

# メイン実行
# - 元のディレクトリを保存
# - プロジェクトディレクトリに移動
# - スクリプト実行
# - 元のディレクトリに戻る
```

### プロファイル追加テンプレート
```powershell
function Start-[ツール名] {
    Push-Location [プロジェクトパス]
    try {
        .\[スクリプト名].ps1 @args
    } finally {
        Pop-Location
    }
}
Set-Alias [エイリアス] Start-[ツール名]
```

---

## 🤖 自動学習ループの組み込み

ランチャースクリプトに「自動学習」の観点を足すと、AIエージェントに毎回同じ指示を書く手間が減り、X／note／Threadsなど複数チャネルの成果で自己改善できるようになります。以下の5ステップをテンプレに組み込むのがおすすめです。

### 1. マルチチャネル現状インプット
- `-Ingest` や `-Sync` オプションで直近投稿の指標を収集（例: impressions, saves, CTR）。
- ランチャー側で `data/social_stats/latest.json` などに保存し、プラットフォームごとの偏りを可視化。
- 取得できないチャネルは「⛔ 未接続: Threads」のように次のアクションを表示。

### 2. 目的と成果物の明示
- `-Goal "noteでリード10件" -Deliverable "2600文字記事"` のようにCLIオプションを定義。
- ランチャーは受け取った目的をAIプロンプトのヘッダに自動挿入し、実行前にチェックリストを表示。

### 3. 成果の数値検証フック
- `-Review` 実行で前回の投稿結果を呼び出し、KPIラダー（例: View→Engagement→Conversion）を表にしてWrite-Host。
- 指標が閾値未満なら `Write-Warning` で改善優先度を提示し、Next Stepを3件まで明示。

### 4. AIへの改善指示生成
- ランチャーがメトリクス差分から「改善プロンプト」を自動生成し、AIに渡すテンプレを `logs/ai_learning_prompts/{date}.md` として保存。
- 例: クリック率が低い場合に `CTAの強化案を3つ出す` などの命令文を付与。

### 5. 過去出力フィードバックで再教育
- `-Replay` で過去の成功例／失敗例をまとめたスニペットをAIに先頭で読み込ませる。
- メタデータ（日時、ターゲット、反応値）をJSONに保持しておき、ランチャーが最新3件を自動添付。

#### 実装サンプル断片
```powershell
param(
      [switch]$Ingest,
      [switch]$Review,
      [string]$Goal,
      [string]$Deliverable,
      [switch]$Replay
)

if ($Ingest) {
      Write-Header "📥 X/note/Threads 指標を収集中"
      # TODO: API呼び出し or CSV読み込み
      Save-SocialSnapshot -Output "data/social_stats/latest.json"
}

$learningContext = Get-LearningPacket -Goal $Goal -Deliverable $Deliverable -Replay:$Replay
Invoke-AITool -Context $learningContext
```

#### データ保存のおすすめ構造
```
learning/
   snapshots/
      2025-11-14_x_metrics.json
      2025-11-14_note_metrics.json
   prompts/
      2025-11-14_goal_note_lead.md
   feedback/
      2025-11-14_summary.csv
```

- `snapshots`: 各チャネルKPIをISO日付で保存（impressions, engagements, saves, conversions など）
- `prompts`: 目的・成果物・改善指示を記録し、AIへの入力再利用に備える
- `feedback`: 実績値＋気づきメモ（例: CTAを変えたら保存率+12%）を表形式で残す

上記をテンプレの「追加要件」として盛り込むことで、どのランチャーでも同じ学習ループを再利用できます。

---

## 🎨 カスタマイズポイント

### 1. 絵文字の選択
```
📝 入力系
🚀 実行系
✅ 成功
❌ エラー
⚠️  警告
💡 ヒント
🔧 設定
📊 レポート
🔍 検索
💾 保存
```

### 2. エラーメッセージ設計
```powershell
if (-not $condition) {
    Write-Host "❌ [何が起きたか]" -ForegroundColor Red
    Write-Host "   [原因]"
    Write-Host "   [解決方法]:"
    Write-Host "   [具体的なコマンド]" -ForegroundColor Yellow
    exit 1
}
```

### 3. 進捗表示
```powershell
Write-Host "🔍 環境チェック中..." -ForegroundColor Gray
# 処理
Write-Success "環境チェック完了"
```

---

## 💡 プロンプト最適化のコツ

### 明確にすること
1. **ツールの目的**を1行で
2. **依存関係**を全てリスト
3. **エラーケース**を想定して列挙
4. **エイリアス名**を具体的に指定
5. **ディレクトリ構造**を明示

### 追加すると良い指示
```
- エラーメッセージは具体的な解決策を含める
- ヘルプは絵文字で読みやすく
- セットアップは対話形式で
- 設定済みの項目はスキップ可能に
- 実行後に次のアクション提案
```

---

## 🚀 実行例

### 基本的なプロンプト
```
Pythonスクリプト tools/deploy.py を実行するPowerShellランチャーを作成。
エイリアスは deploy, d。
-Help, -Setup, -DryRun オプション実装。
どこからでも実行可能に。
```

### 詳細プロンプト
```
以下の要件でPowerShellランチャーを作成:

ツール: デプロイメントツール
パス: tools/deploy.py
エイリアス: deploy, d

機能:
- ヘルプ
- セットアップ（AWS認証情報設定）
- ドライラン（-DryRun）
- 環境指定（-Env [dev|staging|prod]）

要件:
1. どこからでも実行可能
2. AWS認証チェック
3. 環境別の色分け（dev=緑、staging=黄、prod=赤）
4. デプロイ前に確認プロンプト
5. ロールバック機能（-Rollback）

追加:
- Slack通知
- デプロイログ保存
```

---

## � 応用例4: SNSマネタイズプランツール

```
以下の要件でPowerShellランチャースクリプトを作成してください：

【ツール名】: SNSマネタイズプラン生成ツール
【スクリプトパス】: tools\monetize_planner.py
【機能】:
- ヘルプ表示（-Help）
- 初回セットアップ（-Setup）: pip install, API設定ガイド
- 対話型質問（引数なし）: STEP1の20以上の質問に回答
- OpenAI API自動生成（-Api）
- プロンプトのみ生成（-PromptOnly）
- 保存済み回答読み込み（-Load [ファイルパス]）

【要件】:
1. どのディレクトリからでも実行可能にする
   - エイリアス: monetize, mz
2. エラー時に次のステップを明示
   - Pythonなし → インストールガイド
   - 依存パッケージなし → セットアップ提案
   - API Key未設定 → GitHub Copilot Chat統合推奨
3. 依存関係の自動チェック
   - Python存在確認
   - openai, pyperclip パッケージ確認
4. カラフルな出力（絵文字使用）
   - STEP1: 対話型で質問を1つずつ表示
   - STEP2: プロンプト生成完了を明示
5. PowerShellプロファイルへの自動追加
   - Push-Location/Pop-Location で元のディレクトリに戻る
   - 起動時メッセージ表示
6. 短縮エイリアス: mz

【追加要件】:
- STEP1の回答をJSON形式で保存・再利用可能
- 生成されたプロンプトをクリップボードにコピー
- OpenAI API使用時は1万文字以上の詳細プラン生成
- GitHub Copilot Chat統合モードをデフォルトで推奨
- 出力ディレクトリ: outputs/monetize/
```

---

## 🔧 応用例5: パッケージビルドツール

```
【ツール名】: パッケージビルドツール
【スクリプトパス】: build.py
【エイリアス】: build, b

【機能】:
- ビルド実行（引数なし）
- クリーンビルド（-Clean）
- リリースビルド（-Release）
- バージョン指定（-Version [番号]）

【要件】:
1. ビルド成果物のパス表示
2. ビルド時間計測
3. エラー時の詳細ログ表示
4. 成功時に成果物を自動で開く

【追加】:
- GitHub Releaseへの自動アップロード（-Publish）
- 変更履歴自動生成
```

---

## 🎯 品質向上プロンプトテクニック

### 極限まで品質を上げるプロンプト
プロンプトの最後に以下を追加すると、AIが不明点を全て確認してから回答します：

```
【品質担保】
回答の品質を極限まで上げるために、必要な情報はどんな細かいことでも必ず全て質問してください。
```

**実践例**:
```
以下の要件でPowerShellランチャーを作成:

ツール: APIテストツール
パス: tests/api_test.py
エイリアス: apitest, at

（...要件を記載...）

【品質担保】
回答の品質を極限まで上げるために、必要な情報はどんな細かいことでも必ず全て質問してください。
```

---

### より具体的に誘導するプロンプト
AIの前提条件を明示させることで、認識ズレを防ぎます：

```
【前提確認】
回答を生成する前に、あなたがこのタスクを遂行するために設定した前提条件や解釈を箇条書きで提示し、私の認識と合っているか確認してください。
```

**効果**:
- AIが暗黙的に仮定していることが可視化される
- 「こういうパターンだろう」という推測を事前に修正できる
- 手戻りが減る

---

### 見落とし指摘のプロンプト
専門家の視点で不足情報を指摘してもらいます：

```
【チェックリスト】
このタスクを進める上で、私が提示した情報以外に、通常考慮すべき（しかし言及されていない）重要な論点や必要なデータがあれば、それを指摘し、質問してください。
```

**実例**:
```
デプロイツールのランチャーを作成してください。

本番環境へのデプロイ機能を含みます。

【チェックリスト】
このタスクを進める上で、私が提示した情報以外に、通常考慮すべき（しかし言及されていない）重要な論点や必要なデータがあれば、それを指摘し、質問してください。
```

→ AIが「ロールバック機能は？」「確認プロンプトは？」「ログ保存は？」と質問してくれる

---

### 自己評価プロンプト
回答後に改善点を提示させます：

```
【自己評価】
今の回答の品質を10倍にするために、あなたは私に【尋ねるべきだった】質問を、重要度の高い順に3つ挙げてください。
```

**使い方**:
1. 最初のプロンプトで回答を得る
2. その回答に対して「【自己評価】...」を送信
3. AIが「本当は○○を確認すべきでした」と教えてくれる
4. その情報を追加して再生成

---

## 🚀 品質向上プロンプトの組み合わせ例

### パターンA: 最初から全部聞く
```
以下の要件でPowerShellランチャーを作成:

ツール: [ツール名]
パス: [パス]
機能: [機能リスト]

【品質担保】
回答の品質を極限まで上げるために、必要な情報はどんな細かいことでも必ず全て質問してください。

【前提確認】
回答を生成する前に、あなたがこのタスクを遂行するために設定した前提条件や解釈を箇条書きで提示し、私の認識と合っているか確認してください。

【チェックリスト】
このタスクを進める上で、私が提示した情報以外に、通常考慮すべき（しかし言及されていない）重要な論点や必要なデータがあれば、それを指摘し、質問してください。
```

### パターンB: 段階的に精度を上げる
```
# 1回目: シンプルなプロンプト
「APIテストツールのPowerShellランチャーを作成」

# 2回目: 自己評価で改善点を抽出
「【自己評価】今の回答の品質を10倍にするために、あなたは私に【尋ねるべきだった】質問を、重要度の高い順に3つ挙げてください。」

# 3回目: 指摘された情報を追加して再生成
「以下の追加情報でランチャーを再作成:
- エンドポイント: https://api.example.com
- 認証: Bearer Token
- テスト種類: Unit, Integration, E2E」
```

---

## 📊 品質向上プロンプトの効果測定

| プロンプト | 質問数 | 手戻り | 完成度 |
|-----------|--------|--------|--------|
| 基本のみ | 0回 | 2-3回 | 60% |
| +品質担保 | 2-4回 | 1回 | 80% |
| +前提確認 | 3-5回 | 0-1回 | 90% |
| +チェックリスト | 4-6回 | 0回 | 95% |
| 全部盛り | 5-8回 | 0回 | 98% |

**結論**: 最初に時間をかけて質問してもらう方が、最終的に早く完成する

---

## 💡 実践のコツ

### いつ使うべきか
- ✅ 複雑なツール（多機能、依存関係多数）
- ✅ 本番環境に影響するツール（デプロイ、DB操作）
- ✅ チーム共有するツール（他人も使う）
- ⚠️ シンプルなツール → 基本プロンプトで十分

### 時短テクニック
1. **テンプレート化**: 品質向上プロンプトをファイルに保存
2. **段階的適用**: 最初は基本 → 不満があれば品質向上プロンプト追加
3. **学習効果**: 何度か使うと、自分で最初から必要情報を盛り込めるようになる

---

## 📝 品質向上プロンプト集（コピペ用）

### 完全版（全部盛り）
```
【品質担保】
回答の品質を極限まで上げるために、必要な情報はどんな細かいことでも必ず全て質問してください。

【前提確認】
回答を生成する前に、あなたがこのタスクを遂行するために設定した前提条件や解釈を箇条書きで提示し、私の認識と合っているか確認してください。

【チェックリスト】
このタスクを進める上で、私が提示した情報以外に、通常考慮すべき（しかし言及されていない）重要な論点や必要なデータがあれば、それを指摘し、質問してください。
```

### 事後改善用
```
【自己評価】
今の回答の品質を10倍にするために、あなたは私に【尋ねるべきだった】質問を、重要度の高い順に3つ挙げてください。
```

---

これらのテンプレートを使えば、どんなツールでも即座にPowerShellランチャー化できます！🎉

**保存場所**: `C:\Repos\note-articles\PowerShell-Launcher-Template.md`

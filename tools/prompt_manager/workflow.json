{
  "name": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "line-prompt",
        "responseMode": "responseNode",
        "options": {}
      },
      "name": "LINE Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300],
      "webhookId": "ç”Ÿæˆã•ã‚Œã‚‹"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "string": [
                  {
                    "value1": "={{ $json.events[0].message.text }}",
                    "operation": "startsWith",
                    "value2": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:"
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "save"
            },
            {
              "conditions": {
                "string": [
                  {
                    "value1": "={{ $json.events[0].message.text }}",
                    "operation": "startsWith",
                    "value2": "æ¤œç´¢"
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "search"
            },
            {
              "conditions": {
                "string": [
                  {
                    "value1": "={{ $json.events[0].message.text }}",
                    "operation": "equals",
                    "value2": "ä¸€è¦§"
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "list"
            },
            {
              "conditions": {
                "string": [
                  {
                    "value1": "={{ $json.events[0].message.text }}",
                    "operation": "startsWith",
                    "value2": "ã‚¿ã‚°"
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "tag_search"
            },
            {
              "conditions": {
                "string": [
                  {
                    "value1": "={{ $json.events[0].message.text }}",
                    "operation": "startsWith",
                    "value2": "ãŠæ°—ã«å…¥ã‚Š"
                  }
                ]
              },
              "renameOutput": true,
              "outputKey": "favorite"
            }
          ]
        },
        "fallbackOutput": "extra"
      },
      "name": "ã‚³ãƒãƒ³ãƒ‰åˆ¤å®š",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [450, 300]
    },
    {
      "parameters": {
        "functionCode": "// ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º\nconst text = $input.item.json.events[0].message.text;\nconst prompt = text.replace(/^ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:\\s*/, '').trim();\n\n// ç°¡æ˜“çš„ãªã‚«ãƒ†ã‚´ãƒªè‡ªå‹•åˆ¤å®š\nlet category = 'ãã®ä»–';\nconst tags = [];\n\nif (prompt.match(/ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°|SEO|åºƒå‘Š|é›†å®¢/)) {\n  category = 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°';\n  tags.push('ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°');\n}\nif (prompt.match(/ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°|ã‚³ãƒ¼ãƒ‰|Python|JavaScript|é–‹ç™º/)) {\n  category = 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°';\n  tags.push('ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°');\n}\nif (prompt.match(/ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°|è¨˜äº‹|æ–‡ç« |ã‚³ãƒ”ãƒ¼/)) {\n  category = 'ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°';\n  tags.push('ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°');\n}\nif (prompt.match(/ãƒ“ã‚¸ãƒã‚¹|æˆ¦ç•¥|çµŒå–¶|åˆ†æ/)) {\n  category = 'ãƒ“ã‚¸ãƒã‚¹';\n  tags.push('ãƒ“ã‚¸ãƒã‚¹');\n}\nif (prompt.match(/ãƒ‡ãƒ¼ã‚¿|åˆ†æ|çµ±è¨ˆ/)) {\n  tags.push('ãƒ‡ãƒ¼ã‚¿åˆ†æ');\n}\nif (prompt.match(/AI|ChatGPT|Claude/)) {\n  tags.push('AI');\n}\n\nreturn {\n  json: {\n    prompt: prompt,\n    category: category,\n    tags: tags,\n    replyToken: $input.item.json.events[0].replyToken\n  }\n};"
      },
      "name": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè§£æ",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [650, 200]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": "={{ $env.NOTION_DATABASE_ID }}",
        "simple": false,
        "properties": {
          "property": [
            {
              "key": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ",
              "type": "rich_text",
              "richTextValue": "={{ $json.prompt }}"
            },
            {
              "key": "ã‚«ãƒ†ã‚´ãƒª",
              "type": "select",
              "selectValue": "={{ $json.category }}"
            },
            {
              "key": "ã‚¿ã‚°",
              "type": "multi_select",
              "multiSelectValue": "={{ $json.tags }}"
            },
            {
              "key": "ãƒ¡ãƒ¢",
              "type": "rich_text",
              "richTextValue": "LINEã‹ã‚‰è‡ªå‹•ä¿å­˜"
            }
          ]
        }
      },
      "name": "Notionä¿å­˜",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [850, 200],
      "credentials": {
        "notionApi": {
          "id": "èªè¨¼æƒ…å ±ID",
          "name": "Notion API"
        }
      }
    },
    {
      "parameters": {
        "authentication": "lineApi",
        "resource": "message",
        "operation": "reply",
        "replyToken": "={{ $json.replyToken }}",
        "messages": {
          "message": [
            {
              "type": "text",
              "text": "âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸï¼\n\nã‚«ãƒ†ï¿½ã‚´ãƒª: {{ $json.category }}\nã‚¿ã‚°: {{ $json.tags.join(', ') }}\n\nNotionã§ç¢ºèªã§ãã¾ã™ã€‚"
            }
          ]
        }
      },
      "name": "ä¿å­˜å®Œäº†é€šçŸ¥",
      "type": "n8n-nodes-base.line",
      "typeVersion": 1,
      "position": [1050, 200],
      "credentials": {
        "lineApi": {
          "id": "èªè¨¼æƒ…å ±ID",
          "name": "LINE API"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º\nconst text = $input.item.json.events[0].message.text;\nconst keyword = text.replace(/^æ¤œç´¢\\s*/, '').trim();\n\nreturn {\n  json: {\n    keyword: keyword,\n    replyToken: $input.item.json.events[0].replyToken\n  }\n};"
      },
      "name": "æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [650, 350]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": "={{ $env.NOTION_DATABASE_ID }}",
        "returnAll": false,
        "limit": 10,
        "filters": {
          "conditions": [
            {
              "key": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ",
              "type": "text",
              "condition": "contains",
              "value": "={{ $json.keyword }}"
            }
          ]
        }
      },
      "name": "Notionæ¤œç´¢",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [850, 350],
      "credentials": {
        "notionApi": {
          "id": "èªè¨¼æƒ…å ±ID",
          "name": "Notion API"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// æ¤œç´¢çµæœãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ\nconst results = $input.all();\n\nif (results.length === 0) {\n  return {\n    json: {\n      message: 'è©²å½“ã™ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚',\n      replyToken: results[0].json.replyToken\n    }\n  };\n}\n\nlet message = `ğŸ” æ¤œç´¢çµæœ: ${results.length}ä»¶\\n\\n`;\n\nresults.forEach((item, index) => {\n  const props = item.json.properties;\n  const prompt = props.ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ.rich_text[0]?.plain_text || '';\n  const category = props.ã‚«ãƒ†ã‚´ãƒª?.select?.name || 'ãªã—';\n  const preview = prompt.length > 50 ? prompt.substring(0, 50) + '...' : prompt;\n  \n  message += `${index + 1}. [${category}]\\n${preview}\\n\\n`;\n});\n\nmessage += 'Notionã§è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™ã€‚';\n\nreturn {\n  json: {\n    message: message,\n    replyToken: results[0].json.replyToken\n  }\n};"
      },
      "name": "æ¤œç´¢çµæœæ•´å½¢",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1050, 350]
    },
    {
      "parameters": {
        "authentication": "lineApi",
        "resource": "message",
        "operation": "reply",
        "replyToken": "={{ $json.replyToken }}",
        "messages": {
          "message": [
            {
              "type": "text",
              "text": "={{ $json.message }}"
            }
          ]
        }
      },
      "name": "æ¤œç´¢çµæœè¿”ä¿¡",
      "type": "n8n-nodes-base.line",
      "typeVersion": 1,
      "position": [1250, 350],
      "credentials": {
        "lineApi": {
          "id": "èªè¨¼æƒ…å ±ID",
          "name": "LINE API"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": "={{ $env.NOTION_DATABASE_ID }}",
        "returnAll": false,
        "limit": 10,
        "sort": {
          "sortValue": [
            {
              "key": "ä¿å­˜æ—¥æ™‚",
              "type": "created_time",
              "direction": "descending"
            }
          ]
        }
      },
      "name": "Notionæœ€æ–°å–å¾—",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [850, 500],
      "credentials": {
        "notionApi": {
          "id": "èªè¨¼æƒ…å ±ID",
          "name": "Notion API"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// ä¸€è¦§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ\nconst results = $input.all();\nconst replyToken = $input.item.json.events[0].replyToken;\n\nif (results.length === 0) {\n  return {\n    json: {\n      message: 'ã¾ã ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒä¿å­˜ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚',\n      replyToken: replyToken\n    }\n  };\n}\n\nlet message = `ğŸ“‹ æœ€æ–°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ ${results.length}ä»¶\\n\\n`;\n\nresults.forEach((item, index) => {\n  const props = item.json.properties;\n  const prompt = props.ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ.rich_text[0]?.plain_text || '';\n  const category = props.ã‚«ãƒ†ã‚´ãƒª?.select?.name || 'ãªã—';\n  const preview = prompt.length > 40 ? prompt.substring(0, 40) + '...' : prompt;\n  \n  message += `${index + 1}. [${category}]\\n${preview}\\n\\n`;\n});\n\nmessage += 'Notionã§è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™ã€‚';\n\nreturn {\n  json: {\n    message: message,\n    replyToken: replyToken\n  }\n};"
      },
      "name": "ä¸€è¦§æ•´å½¢",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1050, 500]
    },
    {
      "parameters": {
        "authentication": "lineApi",
        "resource": "message",
        "operation": "reply",
        "replyToken": "={{ $json.replyToken }}",
        "messages": {
          "message": [
            {
              "type": "text",
              "text": "={{ $json.message }}"
            }
          ]
        }
      },
      "name": "ä¸€è¦§è¿”ä¿¡",
      "type": "n8n-nodes-base.line",
      "typeVersion": 1,
      "position": [1250, 500],
      "credentials": {
        "lineApi": {
          "id": "èªè¨¼æƒ…å ±ID",
          "name": "LINE API"
        }
      }
    },
    {
      "parameters": {
        "authentication": "lineApi",
        "resource": "message",
        "operation": "reply",
        "replyToken": "={{ $json.events[0].replyToken }}",
        "messages": {
          "message": [
            {
              "type": "text",
              "text": "ä½¿ã„æ–¹:\\n\\nğŸ“ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿å­˜\\nã€Œãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: ã‚ãªãŸã®æ–‡ç« ...ã€\\n\\nğŸ” æ¤œç´¢\\nã€Œæ¤œç´¢ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€\\n\\nğŸ“‹ ä¸€è¦§\\nã€Œä¸€è¦§ã€\\n\\nğŸ·ï¸ ã‚¿ã‚°æ¤œç´¢\\nã€Œã‚¿ã‚° ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã€\\n\\nâ­ ãŠæ°—ã«å…¥ã‚Š\\nã€ŒãŠæ°—ã«å…¥ã‚Š 3ã€(3ç•ªç›®ã‚’ç™»éŒ²)"
            }
          ]
        }
      },
      "name": "ãƒ˜ãƒ«ãƒ—è¿”ä¿¡",
      "type": "n8n-nodes-base.line",
      "typeVersion": 1,
      "position": [650, 600],
      "credentials": {
        "lineApi": {
          "id": "èªè¨¼æƒ…å ±ID",
          "name": "LINE API"
        }
      }
    }
  ],
  "connections": {
    "LINE Webhook": {
      "main": [
        [
          {
            "node": "ã‚³ãƒãƒ³ãƒ‰åˆ¤å®š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ã‚³ãƒãƒ³ãƒ‰åˆ¤å®š": {
      "main": [
        [
          {
            "node": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè§£æ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Notionæœ€æ–°å–å¾—",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [],
        [
          {
            "node": "ãƒ˜ãƒ«ãƒ—è¿”ä¿¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè§£æ": {
      "main": [
        [
          {
            "node": "Notionä¿å­˜",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notionä¿å­˜": {
      "main": [
        [
          {
            "node": "ä¿å­˜å®Œäº†é€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º": {
      "main": [
        [
          {
            "node": "Notionæ¤œç´¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notionæ¤œç´¢": {
      "main": [
        [
          {
            "node": "æ¤œç´¢çµæœæ•´å½¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¤œç´¢çµæœæ•´å½¢": {
      "main": [
        [
          {
            "node": "æ¤œç´¢çµæœè¿”ä¿¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notionæœ€æ–°å–å¾—": {
      "main": [
        [
          {
            "node": "ä¸€è¦§æ•´å½¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸€è¦§æ•´å½¢": {
      "main": [
        [
          {
            "node": "ä¸€è¦§è¿”ä¿¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-11-16T00:00:00.000Z",
  "versionId": "1"
}

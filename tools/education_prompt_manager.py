#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""æ•™è‚²ã‚«ãƒ†ã‚´ãƒªã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ç›®çš„:
  - 6ã¤ã®æ•™è‚²ã‚«ãƒ†ã‚´ãƒªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä¸€å…ƒç®¡ç†
  - CLIã‹ã‚‰ä¸€è¦§è¡¨ç¤º / å€‹åˆ¥ãƒ†ãƒ³ãƒ—ãƒ¬è¡¨ç¤º / ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€äº‹å‰åŸ‹ã‚è¾¼ã¿
  - OpenAI APIçµ±åˆã§ãƒ¯ãƒ³ã‚¹ãƒˆãƒƒãƒ—æŠ•ç¨¿ç”Ÿæˆ
  - ä»Šå¾Œã®ã‚«ãƒ†ã‚´ãƒªè¿½åŠ ãŒå®¹æ˜“ãªæ§‹é€ 

ä½¿ã„æ–¹ (PowerShell):
  python tools/education_prompt_manager.py --list
  python tools/education_prompt_manager.py --show ä¿¡ç”¨
  python tools/education_prompt_manager.py --show 1
    python tools/education_prompt_manager.py --prefill ä¿¡ç”¨ \
        --goal "ç„¡æ–™ç›¸è«‡ç™»éŒ²" \
        --persona "30ä»£å¾ŒåŠ BtoBå–¶æ¥­" \
        --pain "åŠªåŠ›ãŒæ•°å­—ã«åæ˜ ã•ã‚Œãªã„" \
        --tone "å…±æ„Ÿçš„ã‹ã¤é™ã‹ãªè‡ªä¿¡"
  python tools/education_prompt_manager.py            # å¯¾è©±ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆæŠ•ç¨¿è‡ªå‹•ç”Ÿæˆï¼‰

è¨­è¨ˆãƒ¡ãƒ¢:
  - EDUCATION_PROMPTS ã¯ key=å†…éƒ¨è­˜åˆ¥å­, value dict
  - å„ dict: {"number": int, "label": str, "template": str}
  - è¿½åŠ æ™‚ã¯ README(education_prompts.md)ã«ã‚‚åæ˜ 
  - OPENAI_API_KEY ç’°å¢ƒå¤‰æ•°ãŒã‚ã‚Œã°è‡ªå‹•ç”Ÿæˆã€ãªã‘ã‚Œã°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤º
"""
from __future__ import annotations
import argparse
import os
import sys
from textwrap import dedent
from typing import TypedDict, Dict

# --- ãƒ†ãƒ³ãƒ—ãƒ¬å®šç¾© -----------------------------------------------------------
CREDIT_TEMPLATE = dedent(
    """
    ã€ä¿¡ç”¨ã®æ•™è‚²ã€‘ç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    å½¹å‰²ï¼ˆãƒ­ãƒ¼ãƒ«ï¼‰:
    ã‚ãªãŸã¯ã€ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼ã¨ã®é–“ã«å¼·å›ºãªä¿¡é ¼é–¢ä¿‚ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ã‚’å°‚é–€ã¨ã™ã‚‹ã€
    ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ã‚¹ãƒˆã§ã™ã€‚

    æœ€çµ‚ç›®çš„ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰:
    {goal}

    ä¸Šè¨˜ã‚´ãƒ¼ãƒ«é”æˆã®åœŸå°ã¨ã—ã¦ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã€Œã“ã®ç™ºä¿¡è€…ã¯ä¿¡é ¼ã§ãã‚‹ã€
    ã€Œç§ã®ã“ã¨ã‚’æ·±ãç†è§£ã—ã¦ãã‚Œã¦ã„ã‚‹ã€ã¨å¼·ãèªè­˜ã•ã›ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

    ãƒšãƒ«ã‚½ãƒŠï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰:
    {persona}

    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹å•é¡Œç‚¹ï¼ˆå‰æï¼‰:
    {pain}

    ãƒˆãƒ¼ãƒ³ï¼†ãƒãƒŠãƒ¼:
    {tone}

    ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆä¿¡ç”¨ã®æ•™è‚²ï¼‰:
    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®è­¦æˆ’å¿ƒã‚’è§£ãã€å¿ƒç†çš„ãªç¹‹ãŒã‚Šã‚’ç¯‰ãã“ã¨ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚

    æ·±ã„å…±æ„Ÿã®è¡¨æ˜:
    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹ {pain} ã«å¯¾ã—ã¦ã€ã€Œã‚ã‹ã‚Šã¾ã™ã€ã€Œç§ã‚‚ãã†ã§ã—ãŸã€ãªã©ã®å…·ä½“çš„å…±æ„Ÿã€‚
    è¨€èªåŒ–ã§ãã¦ã„ãªã„æ„Ÿæƒ…ã‚„çŠ¶æ³ã‚’ä»£å¼ã—ã¾ã™ã€‚
    ï¼ˆä¾‹ï¼šã€Œã€‡ã€‡ã—ã‚ˆã†ã¨æ€ã£ã¦ã‚‚ã€çµå±€â–³â–³ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã‚ˆã­ã€ï¼‰

    è‡ªå·±é–‹ç¤ºï¼ˆæ¨©å¨æ€§ã¾ãŸã¯è¦ªè¿‘æ„Ÿï¼‰:
    ç™ºä¿¡è€…è‡ªèº«ã®å®Ÿç¸¾ãƒ»å°‚é–€çŸ¥è­˜ã§æ¨©å¨æ€§ã‚’ç¤ºã™ã€ã¾ãŸã¯å¤±æ•—è«‡/å¼±ã¿ã‚’é–‹ç¤ºã—è¦ªè¿‘æ„Ÿã‚’å½¢æˆã€‚

    ç„¡å„Ÿã®ä¾¡å€¤æä¾›ï¼ˆGIVEï¼‰:
    ä»Šã™ãå½¹ç«‹ã¤å°ã•ãªæˆåŠŸä½“é¨“ã‚„æœ‰ç›ŠçŸ¥è­˜ã‚’ç„¡å„Ÿæä¾›ã€‚
    {goal} ã¸ã®å£²ã‚Šè¾¼ã¿ã¯ã›ãšã€è¿”å ±æ€§ã®åŸç†ã‚’åƒã‹ã›ã¾ã™ã€‚

    æŒ‡ç¤ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:
    ç§ãŒã€Œã€‡ã€‡ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦ã€ã¨æŒ‡ç¤ºã—ãŸã‚‰ã€ä¸Šè¨˜ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«åŸºã¥ãã€
    3ãƒ‘ã‚¿ãƒ¼ãƒ³ã®Xãƒã‚¹ãƒˆæ¡ˆã‚’ç”Ÿæˆã€‚å…ˆç”Ÿç›®ç·šã§ã¯ãªããƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç›®ç·šã€‚
    å„æ¡ˆã«ã¯ã€å¿ƒç†çš„æ„å›³ã€‘ã‚’ä½µè¨˜ã—ã¦ãã ã•ã„ã€‚
    """
).strip()


class EducationPromptMeta(TypedDict):
    number: int
    label: str
    template: str


PURPOSE_TEMPLATE = dedent(
    """
    ã€ç›®çš„ã®æ•™è‚²ã€‘ç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    å½¹å‰²ï¼ˆãƒ­ãƒ¼ãƒ«ï¼‰:
    ã‚ãªãŸã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®æ½œåœ¨çš„ãªãƒ‹ãƒ¼ã‚ºã‚„æ¬²æœ›ã‚’é¡•åœ¨åŒ–ã•ã›ã€ãã‚Œã‚’é”æˆå¯èƒ½ãªã€Œç›®çš„ã€ã¨ã—ã¦å¼·ãæ„è­˜ã•ã›ã‚‹ã“ã¨ã‚’å°‚é–€ã¨ã™ã‚‹ã€ãƒ‹ãƒ¼ã‚ºé–‹ç™ºã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã§ã™ã€‚

    æœ€çµ‚ç›®çš„ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰:
    {goal}
    ä¸Šè¨˜ã‚´ãƒ¼ãƒ«ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒã€Œè‡ªã‚‰é”æˆã—ãŸã„ã€ã¨æœ›ã‚€ç†æƒ³æœªæ¥ã¨ã—ã¦æç¤ºã—ã€å¼·çƒˆãªå‹•æ©Ÿä»˜ã‘ã‚’è¡Œã†ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

    ãƒšãƒ«ã‚½ãƒŠï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰:
    {persona}

    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹å•é¡Œç‚¹ï¼ˆå‰æï¼‰:
    {pain}

    ãƒˆãƒ¼ãƒ³ï¼†ãƒãƒŠãƒ¼:
    {tone}

    ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆç›®çš„ã®æ•™è‚²ï¼‰:
    ç¾çŠ¶ç¶­æŒãƒã‚¤ã‚¢ã‚¹ã®ç ´å£Š / ç†æƒ³æœªæ¥ã®å…·ä½“åŒ– / æ¬²æœ›ã®è‚¯å®šã€‚

    ç¾çŠ¶ã¸ã®å•ã„ã‹ã‘:
    ã€Œã„ã¤ã¾ã§ãã®çŠ¶æ…‹ã‚’ç¶šã‘ã¾ã™ã‹ï¼Ÿã€ãªã©ã§åœæ»ã‚’è‡ªè¦šã•ã›ã€
    æ”¾ç½®æ™‚ã®æ©Ÿä¼šæå¤±ã‚’ç¤ºå”†ï¼ˆ{pain} ã‚’æ”¾ç½®ã™ã‚‹ã“ã¨ã§å¤±ã‚ã‚Œã‚‹æœªæ¥ï¼‰ã€‚

    ç†æƒ³æœªæ¥ã®å…·ä½“åŒ–:
    {goal} ã‚’é”æˆã—ãŸéš›ã®å…·ä½“çš„ãªçŠ¶æ…‹ãƒ»æ„Ÿæƒ…ï¼ˆè‡ªç”±/æ‰¿èª/å®‰å¿ƒ ãªã©ï¼‰ã‚’çŸ­ãæå†™ã€‚

    æ¬²æœ›ã®è‚¯å®š:
    æ¨™æº–çš„æ¬²æ±‚ï¼ˆèªã‚ã‚‰ã‚ŒãŸã„/æˆåŠŸã—ãŸã„ ç­‰ï¼‰ã‚’å¥å…¨ãªåŸå‹•åŠ›ã¨ã—ã¦å† framingã€‚

    æŒ‡ç¤ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:
    ã€Œã€‡ã€‡ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦ã€ã§ 3 ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒã‚¹ãƒˆæ¡ˆã‚’ç”Ÿæˆã€‚
    å„æ¡ˆã«ã€å¿ƒç†çš„æ„å›³ã€‘ã‚’ä½µè¨˜ã€‚å…ˆç”Ÿç›®ç·šã§ã¯ãªããƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç›®ç·šã€‚
    """
).strip()

PROBLEM_TEMPLATE = dedent(
    """
    ã€å•é¡Œã®æ•™è‚²ã€‘ç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    å½¹å‰²ï¼ˆãƒ­ãƒ¼ãƒ«ï¼‰:
    ã‚ãªãŸã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒã€Œç›®çš„ã€ã‚’é”æˆã§ããªã„çœŸã®åŸå› ï¼ˆå•é¡Œç‚¹ï¼‰ã‚’é‹­ãæŒ‡æ‘˜ã—ã€
    ãã‚Œã‚’è§£æ±ºã™ã‚‹å¿…è¦æ€§ã‚’èªè­˜ã•ã›ã‚‹å•é¡Œå®šç¾©ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã§ã™ã€‚

    æœ€çµ‚ç›®çš„ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰:
    {goal}
    ã“ã®ã‚´ãƒ¼ãƒ«ã‚’æ±‚ã‚ã‚‹å‰æ®µéšã¨ã—ã¦ã€Œç¾çŠ¶ã®ã¾ã¾ã§ã¯ãƒã‚ºã„ã€ã€Œè‡ªå·±æµã«ã¯é™ç•ŒãŒã‚ã‚‹ã€
    ã¨ã„ã†å±æ©Ÿæ„Ÿã‚’é†¸æˆã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

    ãƒšãƒ«ã‚½ãƒŠï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰:
    {persona}

    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹å•é¡Œç‚¹ï¼ˆå‰æï¼‰:
    {pain}

    ãƒˆãƒ¼ãƒ³ï¼†ãƒãƒŠãƒ¼:
    {tone}

    ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆå•é¡Œã®æ•™è‚²ï¼‰:
    è‡ªå·±æµåŠªåŠ›ã®å¦å®š / çœŸå› å†å®šç¾© / æ”¾ç½®ãƒªã‚¹ã‚¯æç¤ºã€‚

    é–“é•ã£ãŸåŠªåŠ›ã®æŒ‡æ‘˜:
    {pain} ã‚’è§£æ±ºã—ã‚ˆã†ã¨ã—ã¦è¡Œã„ãŒã¡ãªéåŠ¹ç‡æ‰‹æ®µã‚„ä¸€èˆ¬çš„èª¤è§£ã‚’å…·ä½“çš„ã«ä¸€ã¤æç¤ºã€‚

    å•é¡Œç‚¹ã®ã™ã‚Šæ›¿ãˆ:
    æˆæœãŒå‡ºãªã„åŸå› ã‚’ã€Œèƒ½åŠ›ä¸è¶³ã€ã§ã¯ãªãã€Œæ­£ã—ã„æ–¹æ³•è«–ã®æ¬ å¦‚ã€ã«å† framingã€‚

    å±æ©Ÿæ„Ÿã®é†¸æˆ:
    æ”¾ç½®æ™‚ã«ç”Ÿã˜ã‚‹æ©Ÿä¼šæå¤±ã‚„æœªæ¥ã®åœæ»ã‚’çŸ­ãæå†™ï¼ˆä¾‹: 1å¹´å¾Œã‚‚åŒã˜æ‚©ã¿ï¼‰ã€‚

    æŒ‡ç¤ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:
    ã€Œã€‡ã€‡ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦ã€ã§ 3 ãƒ‘ã‚¿ãƒ¼ãƒ³å‡ºåŠ›ã€‚å…ˆç”Ÿç›®ç·šã§ã¯ãªããƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç›®ç·šã€‚
    å„æ¡ˆã«ã€å¿ƒç†çš„æ„å›³ã€‘ã‚’ä½µè¨˜ã—ã¦ãã ã•ã„ã€‚
    """
).strip()

MEANS_TEMPLATE = dedent(
    """
    ã€æ‰‹æ®µã®æ•™è‚²ã€‘ç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    å½¹å‰²ï¼ˆãƒ­ãƒ¼ãƒ«ï¼‰:
    ã‚ãªãŸã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹ã€Œå•é¡Œã€ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®æœ€é©ãªæ‰‹æ®µï¼ˆã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‚’æç¤ºã—ã€
    ãã®ä¾¡å€¤ã‚’é­…åŠ›çš„ã«ä¼ãˆã‚‹ãƒãƒªãƒ¥ãƒ¼ãƒ»ãƒ—ãƒ­ãƒã‚¸ã‚·ãƒ§ãƒ³ãƒ»ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã§ã™ã€‚

    æœ€çµ‚ç›®çš„ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰:
    {goal}
    èªè­˜æ¸ˆã¿ã®å•é¡Œã«å¯¾ã—ã€ã“ã®ã‚´ãƒ¼ãƒ«ï¼ˆå•†å“/ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ãŒç›®çš„é”æˆã¸ã®æœ€è‰¯æ‰‹æ®µã§ã‚ã‚‹æœŸå¾…æ„Ÿã‚’é†¸æˆã—ã¾ã™ã€‚

    ãƒšãƒ«ã‚½ãƒŠï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰:
    {persona}

    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹å•é¡Œç‚¹ï¼ˆå‰æï¼‰:
    {pain}

    ãƒˆãƒ¼ãƒ³ï¼†ãƒãƒŠãƒ¼:
    {tone}

    ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆæ‰‹æ®µã®æ•™è‚²ï¼‰:
    ãƒ™ãƒãƒ•ã‚£ãƒƒãƒˆä¸­å¿ƒ / USPç¤ºå”† / ãƒ†ã‚£ã‚¶ãƒ¼ã«ã‚ˆã‚‹æƒ…å ±å¸Œå°‘æ€§ã€‚

    ãƒ™ãƒãƒ•ã‚£ãƒƒãƒˆæç¤º:
    æ©Ÿèƒ½åˆ—æŒ™ã§ã¯ãªãå¾—ã‚‰ã‚Œã‚‹å…·ä½“çš„æœªæ¥ï¼ˆæ™‚é–“è§£æ”¾ãƒ»å®‰å¿ƒãªã©ï¼‰ã‚’çŸ­ãæå†™ã€‚

    USPç¤ºå”†:
    ä»–æ‰‹æ®µã§ã¯å¾—ã‚‰ã‚Œãªã„å·®åˆ†ã‚’æ§ãˆã‚ã«åŒ‚ã‚ã›ã‚‹ï¼ˆã‚ã‹ã‚‰ã•ã¾åˆ—æŒ™ã¯é¿ã‘ã‚‹ï¼‰ã€‚

    é™å®šçš„é–‹ç¤º(ãƒ†ã‚£ã‚¶ãƒ¼):
    æ ¸å¿ƒã¯ä¸€éƒ¨ã ã‘é–‹ç¤ºã—ç¶šãã¸ã®æ¸‡æœ›æ„Ÿã‚’å½¢æˆï¼ˆ{goal} ã§è©³ç´°ï¼‰ã€‚

    æŒ‡ç¤ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:
    ã€Œã€‡ã€‡ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦ã€ã§ 3 ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆã€‚å„æ¡ˆã«ã€å¿ƒç†çš„æ„å›³ã€‘ä½µè¨˜ã€‚
    """
).strip()

INVEST_TEMPLATE = dedent(
    """
    ã€æŠ•è³‡ã®æ•™è‚²ã€‘ç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    å½¹å‰²ï¼ˆãƒ­ãƒ¼ãƒ«ï¼‰:
    è¡Œå‹•çµŒæ¸ˆå­¦ã¨ä¾¡å€¤ææ¡ˆã®å°‚é–€å®¶ã¨ã—ã¦ã‚³ã‚¹ãƒˆã‚’æœªæ¥ãƒªã‚¿ãƒ¼ãƒ³ç²å¾—ã®æŠ•è³‡ã¸å† framingã€‚

    æœ€çµ‚ç›®çš„ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰:
    {goal}
    ã“ã®ã‚³ã‚¹ãƒˆã‚’"æ¶ˆè²»"ã§ã¯ãªãåˆç†çš„æŠ•è³‡ã¨ã—ã¦èªè­˜ã•ã›è¡Œå‹•æ­£å½“åŒ–ã‚’æ”¯æ´ã—ã¾ã™ã€‚

    ãƒšãƒ«ã‚½ãƒŠï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰:
    {persona}

    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹å•é¡Œç‚¹ï¼ˆå‰æï¼‰:
    {pain}

    ãƒˆãƒ¼ãƒ³ï¼†ãƒãƒŠãƒ¼:
    {tone}

    ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆæŠ•è³‡ã®æ•™è‚²ï¼‰:
    ä¾¡æ ¼ã¨ä¾¡å€¤ã®åˆ†é›¢ / æ©Ÿä¼šæå¤±æ¯”è¼ƒ / ç„¡æ–™ã®é™ç•ŒæŒ‡æ‘˜ã€‚

    ä¾¡æ ¼ã¨ä¾¡å€¤ã®åˆ†é›¢:
    ä¸€æ™‚çš„æ”¯å‡º vs é•·æœŸãƒªã‚¿ãƒ¼ãƒ³ï¼ˆåç›Š/æ™‚é–“/æˆé•·ï¼‰ã€‚ç›¸å¯¾çš„å®‰ã•ã‚’ç¤ºå”†ã€‚

    æ©Ÿä¼šæå¤±æ¯”è¼ƒ:
    è¡Œå‹•ã—ãªã„å ´åˆç¶™ç¶šã™ã‚‹æå¤±ã‚„æµªè²»ã¨ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã€‚

    ç„¡æ–™/å®‰ä¾¡ã®é™ç•Œ:
    æ–­ç‰‡çš„æƒ…å ±ã§ã¯å¤‰åŒ–ãŒé…ã„ â†’ ä½“ç³»æ€§ã«å¯¾ä¾¡ãŒå¿…è¦ã€‚

    æŒ‡ç¤ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:
    ã€Œã€‡ã€‡ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦ã€ã§3æ¡ˆç”Ÿæˆã€‚å„æ¡ˆã€å¿ƒç†çš„æ„å›³ã€‘ä½µè¨˜ã€‚
    """
).strip()

ACTION_TEMPLATE = dedent(
    """
    ã€è¡Œå‹•ã®æ•™è‚²ã€‘ç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    å½¹å‰²ï¼ˆãƒ­ãƒ¼ãƒ«ï¼‰:
    ã‚ãªãŸã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ã€Œæœ€å¾Œã®è¿·ã„ã€ã‚’æ–­ã¡åˆ‡ã‚Šã€"ä»Šã™ã" ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¿ƒã™
    ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã§ã™ã€‚

    æœ€çµ‚ç›®çš„ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰:
    {goal}
    ä¾¡å€¤ã¯ç†è§£ã—ã¦ã„ã‚‹ãŒå…ˆå»¶ã°ã—ã—ã¦ã„ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®èƒŒä¸­ã‚’å¼·ãæŠ¼ã—ã€
    ã“ã®ã‚´ãƒ¼ãƒ«ã®å³æ™‚å®Ÿè¡Œã‚’èª˜ç™ºã™ã‚‹ CTA ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

    ãƒšãƒ«ã‚½ãƒŠï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰:
    {persona}

    ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹å•é¡Œç‚¹ï¼ˆå‰æï¼‰:
    {pain}

    ãƒˆãƒ¼ãƒ³ï¼†ãƒãƒŠãƒ¼:
    {tone}

    ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆè¡Œå‹•ã®æ•™è‚²ï¼‰:
    ã€ŒçŸ¥ã£ã¦ã„ã‚‹ã€ã¨ã€Œã‚„ã‚‹ã€ã¯åˆ¥ç‰©ã§ã‚ã‚‹å¼·èª¿ / é™å®šæ€§ã¨å¸Œå°‘æ€§ / ç·Šæ€¥æ€§ / ç¤¾ä¼šçš„è¨¼æ˜ / éšœå£é™¤å»ã€‚

    è¡Œå‹•ã—ãªã„ãƒªã‚¹ã‚¯å¼·èª¿:
    å…ˆå»¶ã°ã—ã«ã‚ˆã‚‹æ©Ÿä¼šæå¤±ï¼ˆæ™‚é–“/æˆé•·/å¸‚å ´ãƒã‚¸ã‚·ãƒ§ãƒ³å–ªå¤±ï¼‰ã‚’çŸ­ãæå†™ã€‚

    é™å®šæ€§ãƒ»å¸Œå°‘æ€§:
    æ®‹ã‚Šæ /çµ‚äº†æœŸé™ãªã©å…·ä½“çš„åˆ¶ç´„ã‚’ä¸€ã¤æç¤ºï¼ˆä¾‹: "æ®‹ã‚Š3å¸­"ï¼‰ã€‚

    ç·Šæ€¥æ€§ä»˜ä¸:
    ä»Šè¡Œå‹•ã—ãªã„ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ > ã‚ãšã‹ãªæ‰‹é–“ ã‚’å¯¾æ¯”ã— "æœ¬æ—¥ä¸­" ãªã©å³æ™‚èªã‚’æŒ¿å…¥ã€‚

    ç¤¾ä¼šçš„è¨¼æ˜:
    æ—¢ã«è¡Œå‹•ã—ãŸäººã®çµæœ/å£°ã‚’1ã¤å¼•ç”¨ã—å®‰å¿ƒã¨è¿½éšå¿ƒç†ã‚’å–šèµ·ã€‚

    éšœå£é™¤å»:
    æ‰‹ç¶šãç°¡æ˜“æ€§ / æ‰€è¦æ™‚é–“çŸ­ã• / å¤±æ•—æ™‚ã‚µãƒãƒ¼ãƒˆ / è¿”é‡‘ä¿è¨¼ ç­‰ã‹ã‚‰1ã¤é¸ã³æ‘©æ“¦ä½æ¸›ã€‚

    æŒ‡ç¤ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:
    ã€Œã€‡ã€‡ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦ã€ã§ 3 ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆã€‚å„æ¡ˆã«ã€å¿ƒç†çš„æ„å›³ã€‘ä½µè¨˜ã€‚
    280æ–‡å­—ä»¥å†…ã§è¡Œå‹•èª˜ç™ºã‚’æœ€å„ªå…ˆã€‚éåº¦ãªç…½ã‚Šã‚„ææ€–è¡¨ç¾ã¯é¿ã‘ã€å€«ç†çš„å¢ƒç•Œã‚’ç¶­æŒã€‚
    """
).strip()

EDUCATION_PROMPTS: Dict[str, EducationPromptMeta] = {
    "ä¿¡ç”¨": {"number": 1, "label": "ä¿¡ç”¨", "template": CREDIT_TEMPLATE},
    "ç›®çš„": {"number": 2, "label": "ç›®çš„", "template": PURPOSE_TEMPLATE},
    "å•é¡Œ": {"number": 3, "label": "å•é¡Œ", "template": PROBLEM_TEMPLATE},
    "å•é¡Œèªè­˜": {
        "number": 3,
        "label": "å•é¡Œ",
        "template": PROBLEM_TEMPLATE,
    },  # alias
    "æ‰‹æ®µ": {"number": 4, "label": "æ‰‹æ®µ", "template": MEANS_TEMPLATE},
    "è§£æ±ºç­–": {"number": 4, "label": "æ‰‹æ®µ", "template": MEANS_TEMPLATE},  # alias
    "æŠ•è³‡": {"number": 5, "label": "æŠ•è³‡", "template": INVEST_TEMPLATE},
    "æŠ•è³‡æ•™è‚²": {"number": 5, "label": "æŠ•è³‡", "template": INVEST_TEMPLATE},  # alias
    "å¤‰åŒ–æˆæœ": {
        "number": 5,
        "label": "æŠ•è³‡",
        "template": INVEST_TEMPLATE,
    },  # æ—§ãƒ©ãƒ™ãƒ«äº’æ›
    "è¡Œå‹•": {"number": 6, "label": "è¡Œå‹•", "template": ACTION_TEMPLATE},
    "è¡Œå‹•æ„æ€æ±ºå®š": {
        "number": 6,
        "label": "è¡Œå‹•",
        "template": ACTION_TEMPLATE,
    },  # alias
    "ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°": {
        "number": 6,
        "label": "è¡Œå‹•",
        "template": ACTION_TEMPLATE,
    },  # alias è¿½åŠ 
}


DEFAULTS = {
    "goal": "[ã‚´ãƒ¼ãƒ«æœªè¨­å®š]",
    "persona": "[ãƒšãƒ«ã‚½ãƒŠæœªè¨­å®š]",
    "pain": "[å•é¡Œç‚¹æœªè¨­å®š]",
    "tone": "å…±æ„Ÿçš„ã‹ã¤è½ã¡ç€ã„ãŸèªã‚Š",
}

# --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ --------------------------------------------------------


def list_categories() -> str:
    rows = ["ç•ªå· | ã‚«ãƒ†ã‚´ãƒª | çŠ¶æ…‹", "-----|---------|------"]
    seen = set()
    # ã‚½ãƒ¼ãƒˆã—ã¦ç•ªå·æ˜‡é †â†’ãƒ©ãƒ™ãƒ«
    for key, meta in sorted(
        EDUCATION_PROMPTS.items(),
        key=lambda item: (item[1]["number"], item[1]["label"]),
    ):
        ident = (meta["number"], meta["label"])  # ãƒ¦ãƒ‹ãƒ¼ã‚¯è­˜åˆ¥
        if ident in seen:
            continue  # alias é‡è¤‡è¡¨ç¤ºæŠ‘åˆ¶
        seen.add(ident)
        status = "OK" if "(TODO" not in meta["template"] else "TODO"
        rows.append(f"{meta['number']} | {meta['label']} | {status}")
    return "\n".join(rows)


def resolve_category(cat: str) -> str:
    # æ•°å­—æŒ‡å®šè¨±å®¹
    if cat.isdigit():
        for k, v in EDUCATION_PROMPTS.items():
            if v["number"] == int(cat):
                return k
    # å®Œå…¨ä¸€è‡´
    if cat in EDUCATION_PROMPTS:
        return cat
    raise SystemExit(f"ã‚«ãƒ†ã‚´ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {cat}")


def build_prefilled(template: str, **kwargs) -> str:
    data = {**DEFAULTS, **{k: v for k, v in kwargs.items() if v}}
    return template.format(**data)


def generate_posts_with_openai(system_prompt: str, topic: str):
    """OpenAI APIã§æŠ•ç¨¿æ¡ˆã‚’ç”Ÿæˆï¼ˆAPIæœªè¨­å®šæ™‚ã¯Noneè¿”å´ï¼‰"""
    api_key = os.getenv("OPENAI_API_KEY")
    
    if not api_key:
        return None  # APIæœªè¨­å®š
    
    try:
        from openai import OpenAI  # type: ignore
        
        client = OpenAI(api_key=api_key)
        
        user_message = f"{topic}ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦"
        
        response = client.chat.completions.create(
            model="gpt-4o-mini",
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": user_message}
            ],
            temperature=0.8,
            max_tokens=2000
        )
        
        return response.choices[0].message.content
        
    except ImportError:
        print("\nâš ï¸  openaiãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™: pip install openai")
        return None
    except Exception as e:
        print(f"\nâš ï¸  APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼: {e}")
        return None


# --- ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ --------------------------------------------------------


def interactive_menu():
    """å¯¾è©±å½¢å¼ã§ã‚«ãƒ†ã‚´ãƒªé¸æŠâ†’ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€å…¥åŠ›â†’å®Œæˆãƒ†ãƒ³ãƒ—ãƒ¬å‡ºåŠ›"""
    print("\n" + "=" * 60)
    print("  ğŸ“ æ•™è‚²ã‚«ãƒ†ã‚´ãƒªåˆ¥ æŠ•ç¨¿ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆãƒ„ãƒ¼ãƒ«")
    print("=" * 60 + "\n")
    
    print("ã€åˆ©ç”¨å¯èƒ½ãªã‚«ãƒ†ã‚´ãƒªã€‘")
    print(list_categories())
    print()
    
    # Step 1: ã‚«ãƒ†ã‚´ãƒªé¸æŠ
    try:
        choice = input(
            "ğŸ“Œ ä½¿ã„ãŸã„ã‚«ãƒ†ã‚´ãƒªã®ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (1ã€œ6): "
        ).strip()
    except (EOFError, KeyboardInterrupt):
        print("\n\nä¸­æ–­ã•ã‚Œã¾ã—ãŸã€‚")
        return 1
    
    if not choice:
        print("å…¥åŠ›ãªã—ã€‚çµ‚äº†ã—ã¾ã™ã€‚")
        return 0
    
    try:
        key = resolve_category(choice)
    except SystemExit as e:
        print(f"\nâŒ {e}")
        return 1
    
    meta = EDUCATION_PROMPTS[key]
    category_name = meta["label"]
    
    print(f"\nâœ… ã€{category_name}ã®æ•™è‚²ã€‘ã‚’é¸æŠã—ã¾ã—ãŸ\n")
    print("-" * 60)
    
    # Step 2: ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€å…¥åŠ›ï¼ˆã‚¬ã‚¤ãƒ‰ä»˜ãï¼‰
    print(
        "\nğŸ“ ä»¥ä¸‹ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
        "ï¼ˆEnter ã§ã‚¹ã‚­ãƒƒãƒ— â†’ æ—¢å®šå€¤ä½¿ç”¨ï¼‰\n"
    )
    
    print(
        "1ï¸âƒ£  æœ€çµ‚ã‚´ãƒ¼ãƒ«"
        "ï¼ˆä¾‹: ç„¡æ–™ç›¸è«‡ã«ç™»éŒ²ã€noteè¨˜äº‹ã‚’èª­ã‚€ã€ãƒ¡ãƒ«ãƒã‚¬è³¼èª­ï¼‰"
    )
    goal = input("   â¤ ã‚´ãƒ¼ãƒ«: ").strip() or DEFAULTS["goal"]
    
    print("\n2ï¸âƒ£  ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼ˆãƒšãƒ«ã‚½ãƒŠï¼‰ã®å±æ€§")
    print("   ï¼ˆä¾‹: 30ä»£ä¼šç¤¾å“¡/å‰¯æ¥­ã«æŒ‘æˆ¦ä¸­/æƒ…å ±åé›†ã¯æ¸ˆã‚“ã§ã„ã‚‹ï¼‰")
    persona = input("   â¤ ãƒšãƒ«ã‚½ãƒŠ: ").strip() or DEFAULTS["persona"]
    
    print("\n3ï¸âƒ£  ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæŠ±ãˆã‚‹å•é¡Œãƒ»æ‚©ã¿ãƒ»å¿ƒç†çš„éšœå£")
    print("   ï¼ˆä¾‹: åŠªåŠ›ãŒæ•°å­—ã«åæ˜ ã•ã‚Œãªã„ã€å…ˆå»¶ã°ã—ç™–ãŒã‚ã‚‹ï¼‰")
    pain = input("   â¤ å•é¡Œç‚¹: ").strip() or DEFAULTS["pain"]
    
    print("\n4ï¸âƒ£  æŠ•ç¨¿ã®ãƒˆãƒ¼ãƒ³ï¼ˆèªã‚Šå£ï¼‰")
    print("   ï¼ˆä¾‹: å…±æ„Ÿçš„ã€è«–ç†çš„ã€ç·Šæ€¥æ€§ã‚’é†¸æˆã€åŠ›å¼·ãèƒŒä¸­ã‚’æŠ¼ã™ï¼‰")
    tone = input("   â¤ ãƒˆãƒ¼ãƒ³: ").strip() or DEFAULTS["tone"]
    
    print("\n5ï¸âƒ£  æŠ•ç¨¿ãƒ†ãƒ¼ãƒï¼ˆä½•ã«ã¤ã„ã¦æ›¸ãã‹ï¼‰")
    print("   ï¼ˆä¾‹: å‰¯æ¥­ã§æœˆ5ä¸‡å††ç¨¼ãæ–¹æ³•ã€æ™‚é–“ç®¡ç†è¡“ã€AIæ´»ç”¨äº‹ä¾‹ï¼‰")
    topic = input("   â¤ ãƒ†ãƒ¼ãƒ: ").strip()
    
    if not topic:
        print("\nâŒ ãƒ†ãƒ¼ãƒãŒæœªå…¥åŠ›ã§ã™ã€‚çµ‚äº†ã—ã¾ã™ã€‚")
        return 1
    
    # Step 3: ãƒ†ãƒ³ãƒ—ãƒ¬ç”Ÿæˆ
    print("\n" + "=" * 60)
    print("  ğŸ¯ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆä¸­...")
    print("=" * 60 + "\n")
    
    filled = build_prefilled(
        meta["template"],
        goal=goal,
        persona=persona,
        pain=pain,
        tone=tone,
    )
    
    # Step 4: OpenAI API ã§æŠ•ç¨¿ç”Ÿæˆè©¦è¡Œ
    print("ğŸ¤– AIã§æŠ•ç¨¿æ¡ˆã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™...\n")
    generated = generate_posts_with_openai(filled, topic)
    
    if generated:
        # æˆåŠŸ: ç”Ÿæˆã•ã‚ŒãŸæŠ•ç¨¿ã‚’è¡¨ç¤º
        print("=" * 60)
        print(f"  âœ… ã€{topic}ã€‘ã«ã¤ã„ã¦ã®æŠ•ç¨¿æ¡ˆï¼ˆ3ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰")
        print("=" * 60 + "\n")
        print(generated)
        print("\n" + "=" * 60)
        
        # ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼è©¦è¡Œ
        try:
            import pyperclip  # type: ignore
            pyperclip.copy(generated)
            print("ğŸ“‹ æŠ•ç¨¿æ¡ˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\n")
        except ImportError:
            print("ğŸ’¡ ãƒ’ãƒ³ãƒˆ: ä¸Šè¨˜ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ã£ã¦ãã ã•ã„\n")
        except Exception:
            pass
    else:
        # APIæœªè¨­å®šã¾ãŸã¯ã‚¨ãƒ©ãƒ¼: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã¿è¡¨ç¤º
        print("=" * 60)
        print("  â„¹ï¸  OpenAI APIæœªè¨­å®š - ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¡¨ç¤º")
        print("=" * 60 + "\n")
        print(filled)
        print("\n" + "=" * 60)
        print("  ğŸ’¡ ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ChatGPTãªã©ã«è²¼ã‚Šä»˜ã‘ã¦ã€")
        print(f"     ã€Œ{topic}ã«ã¤ã„ã¦ã®æŠ•ç¨¿ã‚’3ã¤ä½œã£ã¦ã€ã¨æŒ‡ç¤ºã—ã¦ãã ã•ã„ã€‚")
        print("=" * 60 + "\n")
        print("  ğŸ”‘ è‡ªå‹•ç”Ÿæˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã«ã¯:")
        print("     1. OpenAI APIã‚­ãƒ¼ã‚’å–å¾—")
        print("     2. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š: $env:OPENAI_API_KEY='sk-...'")
        print("     3. openaiãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: pip install openai")
        print("=" * 60 + "\n")
        
        # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
        try:
            import pyperclip  # type: ignore
            pyperclip.copy(filled)
            print("ğŸ“‹ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\n")
        except ImportError:
            print("ğŸ’¡ ãƒ’ãƒ³ãƒˆ: ä¸Šè¨˜ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„\n")
        except Exception:
            pass
    
    return 0


def main(argv=None):
    parser = argparse.ArgumentParser(description="æ•™è‚²ã‚«ãƒ†ã‚´ãƒªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†")
    parser.add_argument("--list", action="store_true", help="ã‚«ãƒ†ã‚´ãƒªä¸€è¦§è¡¨ç¤º")
    parser.add_argument("--show", metavar="CATEGORY", help="ãƒ†ãƒ³ãƒ—ãƒ¬è¡¨ç¤º (åå‰/ç•ªå·)")
    parser.add_argument(
        "--prefill", metavar="CATEGORY", help="ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€åŸ‹ã‚ã§è¡¨ç¤º"
    )
    parser.add_argument("--goal")
    parser.add_argument("--persona")
    parser.add_argument("--pain")
    parser.add_argument("--tone")

    # å¯¾è©±ãƒ¢ãƒ¼ãƒ‰: å¼•æ•°ãªã—
    if argv is None and len(sys.argv) == 1:
        return interactive_menu()

    args = parser.parse_args(argv)

    if args.list:
        print(list_categories())
        return 0

    if args.show:
        key = resolve_category(args.show)
        tpl = EDUCATION_PROMPTS[key]["template"]
        print(build_prefilled(tpl))
        return 0

    if args.prefill:
        key = resolve_category(args.prefill)
        tpl = EDUCATION_PROMPTS[key]["template"]
        filled = build_prefilled(
            tpl,
            goal=args.goal,
            persona=args.persona,
            pain=args.pain,
            tone=args.tone,
        )
        print(filled)
        return 0

    # ä½•ã‚‚è©²å½“ã—ãªã„å ´åˆã¯ãƒ˜ãƒ«ãƒ—
    parser.print_help()
    return 0


if __name__ == "__main__":  # pragma: no cover
    sys.exit(main())

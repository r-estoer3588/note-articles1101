#!/usr/bin/env python3
"""
Threads Relationship Post Generator

6æ®µéšæ•™è‚²ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯(ä¿¡ç”¨â†’ç›®çš„â†’å•é¡Œâ†’æ‰‹æ®µâ†’æŠ•è³‡â†’è¡Œå‹•)ã«åŸºã¥ã„ãŸ
å¤«å©¦é–¢ä¿‚ãƒ»åŒæ£²ã‚«ãƒƒãƒ—ãƒ«å‘ã‘ThreadsæŠ•ç¨¿ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚

Usage:
    # å¯¾è©±ãƒ¢ãƒ¼ãƒ‰
    python threads_relationship_generator.py

    # ã‚«ãƒ†ã‚´ãƒªæŒ‡å®šç”Ÿæˆ
    python threads_relationship_generator.py --category A --count 10

    # é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”Ÿæˆ
    python threads_relationship_generator.py --week 1

    # CSVå‡ºåŠ›
    python threads_relationship_generator.py --week 1 --output week1.csv
"""

import argparse
import csv
import random
from typing import Dict, List

# ================================
# ã‚«ãƒ†ã‚´ãƒªå®šç¾©(300æŠ•ç¨¿)
# ================================

CATEGORIES = {
    # ã€1-7æ—¥ç›®ã€‘ä¿¡ç”¨æ•™è‚²ãƒ•ã‚§ãƒ¼ã‚º1(70æŠ•ç¨¿)
    "A": {"name": "è‡ªå·±ç´¹ä»‹ãƒ»å®Ÿç¸¾æç¤º", "phase": "ä¿¡ç”¨1", "days": "1-7", "count": 10},
    "B": {"name": "å®¶äº‹ã®è¦‹ãˆã‚‹åŒ–", "phase": "ä¿¡ç”¨1", "days": "1-7", "count": 10},
    "C": {"name": "é£Ÿç”Ÿæ´»æ”¹å–„", "phase": "ä¿¡ç”¨1", "days": "1-7", "count": 10},
    "D": {"name": "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³", "phase": "ä¿¡ç”¨1", "days": "1-7", "count": 10},
    "E": {"name": "å…±æ„Ÿãƒã‚¤ãƒ³ãƒˆ", "phase": "ä¿¡ç”¨1", "days": "1-7", "count": 10},
    "F": {"name": "ã‚¹ãƒˆãƒ¼ãƒªãƒ¼", "phase": "ä¿¡ç”¨1", "days": "1-7", "count": 10},
    "G": {"name": "æ—¥å¸¸ãƒ»æ°—ã¥ã", "phase": "ä¿¡ç”¨1", "days": "1-7", "count": 10},
    
    # ã€8-14æ—¥ç›®ã€‘ä¿¡ç”¨æ•™è‚²ãƒ•ã‚§ãƒ¼ã‚º2(70æŠ•ç¨¿)
    "H": {"name": "å¹´é–“130å›ã®ç§˜å¯†", "phase": "ä¿¡ç”¨2", "days": "8-14", "count": 10},
    "I": {"name": "ãƒ—ãƒãƒ¬ã‚¹æœŸé–“ã®è©±", "phase": "ä¿¡ç”¨2", "days": "8-14", "count": 10},
    "J": {"name": "æ€ã‚ã›ã¶ã‚Šäº‹ä»¶", "phase": "ä¿¡ç”¨2", "days": "8-14", "count": 10},
    "K": {"name": "æ™‚çŸ­ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯", "phase": "ä¿¡ç”¨2", "days": "8-14", "count": 10},
    "L": {"name": "å®Ÿç¸¾ã®æ•°å­—", "phase": "ä¿¡ç”¨2", "days": "8-14", "count": 10},
    "M": {"name": "ãƒ“ãƒ•ã‚©ãƒ¼ã‚¢ãƒ•ã‚¿ãƒ¼", "phase": "ä¿¡ç”¨2", "days": "8-14", "count": 10},
    "N": {"name": "ä¿¡é ¼æ§‹ç¯‰", "phase": "ä¿¡ç”¨2", "days": "8-14", "count": 10},
    
    # ã€15-21æ—¥ç›®ã€‘ç›®çš„æ•™è‚²+å•é¡Œæ•™è‚²(70æŠ•ç¨¿)
    "O": {"name": "ç†æƒ³ã®æœªæ¥", "phase": "ç›®çš„", "days": "15-21", "count": 10},
    "P": {"name": "ãƒ—ãƒãƒ¬ã‚¹ã®è¾›ã•", "phase": "å•é¡Œ", "days": "15-21", "count": 10},
    "Q": {"name": "èª­è€…ã®æ‚©ã¿ã‚’è¨€èªåŒ–", "phase": "å•é¡Œ", "days": "15-21", "count": 10},
    "R": {"name": "å•é¡Œã®åŸå› ", "phase": "å•é¡Œ", "days": "15-21", "count": 10},
    "S": {"name": "å¥³æ€§å¿ƒç†", "phase": "å•é¡Œ", "days": "15-21", "count": 10},
    "T": {"name": "ã‚ˆãã‚ã‚‹é–“é•ã„", "phase": "å•é¡Œ", "days": "15-21", "count": 10},
    "U": {"name": "å¤±æ•—è«‡", "phase": "å•é¡Œ", "days": "15-21", "count": 10},
    "V": {"name": "å¤‰ã‚ã‚‹ãã£ã‹ã‘", "phase": "å•é¡Œ", "days": "15-21", "count": 10},
    
    # ã€22-28æ—¥ç›®ã€‘æ‰‹æ®µæ•™è‚²(70æŠ•ç¨¿)
    "W": {"name": "é£Ÿç”Ÿæ´»æ”¹å–„ã®å…·ä½“ç­–", "phase": "æ‰‹æ®µ", "days": "22-28", "count": 10},
    "X": {"name": "å®¶äº‹ã®è¦‹ãˆã‚‹åŒ–å®Ÿè·µ", "phase": "æ‰‹æ®µ", "days": "22-28", "count": 10},
    "Y": {"name": "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¡“", "phase": "æ‰‹æ®µ", "days": "22-28", "count": 10},
    "Z": {"name": "ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—å†æ§‹ç¯‰", "phase": "æ‰‹æ®µ", "days": "22-28", "count": 10},
    "AA": {"name": "èª˜ã„æ–¹ã®é»„é‡‘ãƒ‘ã‚¿ãƒ¼ãƒ³", "phase": "æ‰‹æ®µ", "days": "22-28", "count": 10},
    "BB": {"name": "æ™‚çŸ­ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯è©³ç´°", "phase": "æ‰‹æ®µ", "days": "22-28", "count": 10},
    "CC": {"name": "ãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆ", "phase": "æ‰‹æ®µ", "days": "22-28", "count": 10},
    
    # ã€29-30æ—¥ç›®ã€‘æŠ•è³‡æ•™è‚²+è¡Œå‹•æ•™è‚²(20æŠ•ç¨¿)
    "DD": {"name": "noteã‚’è²·ã†ã¹ãç†ç”±", "phase": "æŠ•è³‡", "days": "29-30", "count": 10},
    "EE": {"name": "è¡Œå‹•ä¿ƒé€²", "phase": "è¡Œå‹•", "days": "29-30", "count": 10},
}

# ================================
# æŠ•ç¨¿ãƒ†ãƒ¼ãƒå®šç¾©
# ================================

THEMES = {
    "A": [
        "å½¼å¥³ã¨åŒæ£²ã—ã¦ã¾ã™(å­ä¾›ã‚ã‚Š)",
        "çµå©šã¯ã—ã¦ãªã„ã‘ã©å®¶æ—åŒç„¶",
        "äººã«ã¯è¨€ã„ã¥ã‚‰ã„é–¢ä¿‚",
        "ã§ã‚‚å¹´é–“130å›Hã—ã¦ã‚‹",
        "æ¯æ—¥å¹¸ã›ãªç†ç”±",
        "ãªãœç™ºä¿¡ã‚’å§‹ã‚ãŸã‹",
        "ãƒ—ãƒãƒ¬ã‚¹æœŸé–“ã‚‚ã‚ã£ãŸ",
        "ãã®åº¦ã«æ”¹å–„ã—ã¦ããŸ",
        "æ™‚çŸ­ã§ã‚‚ãŠäº’ã„æº€è¶³",
        "ã‚ãªãŸã‚‚å¤‰ã‚ã‚Œã‚‹",
    ],
    "B": [
        "å®¶äº‹ã§æ‰ã‚ãŸæ™‚æœŸ",
        "ãŠäº’ã„ã€Œã‚„ã£ã¦ã‚‹ã€ã¨æ€ã£ã¦ãŸ",
        "Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§å¯è¦–åŒ–",
        "å½¼å¥³ã®è² æ‹…ãŒè¦‹ãˆãŸ",
        "è¦–è¦šåŒ–ã§æ„Ÿè¬ãŒç”Ÿã¾ã‚ŒãŸ",
        "åŒæ£²ã ã‹ã‚‰ã“ãå¹³ç­‰ã«",
        "çµå©šã—ã¦ãªã„ã‹ã‚‰æŸ”è»Ÿ",
        "è¦‹ãˆãªã„å®¶äº‹ã®å­˜åœ¨",
        "å¯è¦–åŒ–ã®ã‚„ã‚Šæ–¹",
        "ã“ã‚Œã§å–§å˜©ãŒæ¸›ã£ãŸ",
    ],
    "C": [
        "ä»•äº‹å¿™ã—ãã¦ç„¡æ°—åŠ›ã ã£ãŸ",
        "å®Ÿã¯é£Ÿäº‹ãŒåŸå› ",
        "ã‚¸ãƒ£ãƒ³ã‚¯ãƒ•ãƒ¼ãƒ‰â†’å’Œé£Ÿã¸",
        "ãƒ‰ãƒ¼ãƒ‘ãƒŸãƒ³éå‰°ã®æ€–ã•",
        "æ°—åŠ›ãŒæˆ»ã£ãŸ",
        "å¤œã‚‚å…ƒæ°—ã«ãªã£ãŸ",
        "1é€±é–“ã®é£Ÿäº‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼",
        "ã‚³ãƒ³ãƒ“ãƒ‹é£¯ã‚„ã‚ãŸç†ç”±",
        "é£Ÿäº‹ã§äººç”Ÿå¤‰ã‚ã‚‹",
        "ã¾ãšé£Ÿäº‹ã‹ã‚‰è¦‹ç›´ã—ã¦",
    ],
    "D": [
        "ä¼šè©±ãŒæ¸›ã£ãŸæ™‚æœŸ",
        "ã™ã‚Œé•ã„ãŒå¢—ãˆãŸ",
        "5åˆ†ã®ä¼šè©±ã‹ã‚‰å†ã‚¹ã‚¿ãƒ¼ãƒˆ",
        "æ„Ÿè¬ã‚’è¨€è‘‰ã«ã™ã‚‹",
        "å½¼å¥³ã®è©±ã‚’èã",
        "ã€Œã‚ã‚ŠãŒã¨ã†ã€ã®åŠ¹æœ",
        "ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—å†æ§‹ç¯‰",
        "ä½•æ°—ãªã„æ—¥å¸¸ãŒå¤§äº‹",
        "å¯ã‚‹å‰ã®10åˆ†ä¼šè©±",
        "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹",
    ],
    "E": [
        "ä»•äº‹ã¨å®¶åº­ã®ä¸¡ç«‹",
        "å­è‚²ã¦ä¸­ã®ã‚«ãƒƒãƒ—ãƒ«",
        "æ™‚é–“ãŒãªã„ä¸­ã§ã®å·¥å¤«",
        "ç–²ã‚Œã¦ã‚‹æ™‚ã“ã",
        "å®Œç’§ã˜ã‚ƒãªãã¦ã„ã„",
        "å°ã•ãªå¤‰åŒ–ã®ç©ã¿é‡ã­",
        "å¤±æ•—ã—ãŸè©±",
        "å½¼å¥³ã«æ€’ã‚‰ã‚ŒãŸè©±",
        "è©¦è¡ŒéŒ¯èª¤ã®æ—¥ã€…",
        "ã‚ãªãŸã¨åŒã˜ã§ã—ãŸ",
    ],
    "F": [
        "å‡ºä¼šã„ã®è©±",
        "åŒæ£²ã‚’æ±ºã‚ãŸç†ç”±",
        "æœ€åˆã®å£",
        "ãŠäº’ã„ã®æˆé•·",
        "ä»ŠãŒã‚ã‚‹ã®ã¯å½¼å¥³ã®ãŠã‹ã’",
        "å¤‰ã‚ã‚ã†ã¨æ±ºã‚ãŸæ—¥",
        "ä¸€ç•ªè¾›ã‹ã£ãŸæ™‚æœŸ",
        "ä¹—ã‚Šè¶ŠãˆãŸæ–¹æ³•",
        "çµå©šã—ã¦ãªãã¦ã‚‚å¹¸ã›",
        "ã“ã‚ŒãŒåƒ•ã‚‰ã®å½¢",
    ],
    "G": [
        "æœã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³",
        "å¸°å®…å¾Œã®ç¿’æ…£",
        "é€±æœ«ã®éã”ã—æ–¹",
        "äºŒäººã§æ±ºã‚ãŸãƒ«ãƒ¼ãƒ«",
        "ãŠäº’ã„ã®æ™‚é–“ã‚’å°Šé‡",
        "ä¸€ç·’ã«ã„ã‚‹æ™‚é–“ã®è³ª",
        "äº›ç´°ãªå–œã³",
        "æ—¥å¸¸ã®å¹¸ã›",
        "å½“ãŸã‚Šå‰ã˜ã‚ƒãªã„",
        "ä»Šæ—¥ã‚‚æ„Ÿè¬",
    ],
    "H": [
        "æ­£ç›´ã«è¨€ã„ã¾ã™ã€å¹´é–“130å›Hã—ã¦ã¾ã™",
        "çµå©šã—ã¦ãªã„ã‚«ãƒƒãƒ—ãƒ«ã§ã™",
        "å¤‰ã‚ã£ãŸã®ã¯3ã¤ã®ã“ã¨",
        "æ™‚çŸ­ã§ã‚‚æº€è¶³ã§ãã‚‹ç†ç”±",
        "å¿™ã—ãã¦ã‚‚ã§ãã‚‹ç§˜å¯†",
        "å›æ•°ã‚ˆã‚Šè³ªãŒå¤§äº‹",
        "ãŠäº’ã„ãŒæ±‚ã‚ã‚‹å½¢",
        "ç„¡ç†ã—ã¦ãªã„",
        "è‡ªç„¶ã¨å¢—ãˆãŸ",
        "ã‚ãªãŸã‚‚ã§ãã‚‹",
    ],
    "I": [
        "å®Ÿã¯æœ€é•·2é€±é–“Hã—ãªã‹ã£ãŸ",
        "åŸå› ã¯ä»•äº‹ã®ç–²ã‚Œ",
        "ã§ã‚‚ãã‚Œã ã‘ã˜ã‚ƒãªã‹ã£ãŸ",
        "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³",
        "ã“ã®ã¾ã¾ã˜ã‚ƒãƒ€ãƒ¡ã ã¨æ€ã£ãŸ",
        "é£Ÿäº‹ã‚’è¦‹ç›´ã—ãŸ",
        "å®¶äº‹ã‚’è¦‹ãˆã‚‹åŒ–ã—ãŸ",
        "2é€±é–“ã§å¾©æ´»",
        "ä»Šã¯é€±3ãƒšãƒ¼ã‚¹",
        "ãƒ—ãƒãƒ¬ã‚¹ã§æ‚©ã‚“ã§ã‚‹äººã¸",
    ],
    "J": [
        "å½¼å¥³ã«æ¿€æ€’ã•ã‚ŒãŸè©±",
        "ã„ã¡ã‚ƒã„ã¡ã‚ƒã™ã‚‹ã®ã«ä½•ã‚‚ã—ãªã„",
        "ã€Œã—ãªã„ãªã‚‰ã™ã‚‹ãª!ã€",
        "å¥³æ€§å¿ƒç†ãŒåˆ†ã‹ã£ã¦ãªã‹ã£ãŸ",
        "ä¸­é€”åŠç«¯ãŒä¸€ç•ªãƒ€ãƒ¡",
        "ç·©æ€¥ãŒå¤§äº‹",
        "ã‚„ã‚‹æ™‚ã¯ã¡ã‚ƒã‚“ã¨ã‚„ã‚‹",
        "ã‚„ã‚‰ãªã„æ™‚ã¯ã‚„ã‚‰ãªã„",
        "æŠ¼ã—å¼•ãã®æŠ€è¡“",
        "ã“ã®å¤±æ•—ã‹ã‚‰å­¦ã‚“ã ",
    ],
    "K": [
        "å¿™ã—ãã¦ã‚‚æº€è¶³ã§ãã‚‹",
        "æ™‚é–“ã‚ˆã‚Šè³ª",
        "15åˆ†ã§ã‚‚ååˆ†",
        "æº–å‚™ãŒ9å‰²",
        "ãŠäº’ã„ã®æ°—æŒã¡ç¢ºèª",
        "æœã®æ™‚é–“æ´»ç”¨",
        "å­ä¾›ãŒå¯ãŸå¾Œ",
        "ã‚¹ã‚­ãƒæ™‚é–“ã®ä½¿ã„æ–¹",
        "åŠ¹ç‡ã‚ˆã‚Šå¿ƒ",
        "æ™‚çŸ­ã§ã‚‚ãŠäº’ã„æº€è¶³",
    ],
    "L": [
        "30å›æº€è¶³ã•ã›ã‚‹è©±",
        "æœ€åˆã¯ä¸‹æ‰‹ã§ã—ãŸ",
        "å­¦ã‚“ã ã“ã¨å®Ÿè·µã—ãŸã“ã¨",
        "ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚ˆã‚Šæ°—æŒã¡",
        "å¥³æ€§ãŒæ±‚ã‚ã¦ã‚‹ã‚‚ã®",
        "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒéµ",
        "ãŠäº’ã„ã‚’ç†è§£ã™ã‚‹",
        "æ•°å­—ã‚ˆã‚Šå¤§åˆ‡ãªã“ã¨",
        "ã§ã‚‚ç›®æ¨™ã¯ã‚ã£ãŸæ–¹ãŒã„ã„",
        "ã‚ãªãŸã‚‚ã§ãã‚‹",
    ],
    "M": [
        "Before: é€±1â†’æœˆ2å›ã«æ¸›å°‘ã€ä¼šè©±æ¸›å°‘ã€ç„¡æ°—åŠ›",
        "After: å¹´é–“130å›ã€æ¯æ—¥å¹¸ã›ã€æ°—åŠ›å……å®Ÿ",
        "å¤‰ã‚ã£ãŸã®ã¯3ã¤ã ã‘",
        "é£Ÿäº‹ãƒ»å®¶äº‹ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "æœ€åˆã®2é€±é–“ã§ã“ã†å¤‰ã‚ã£ãŸ",
        "1ãƒ¶æœˆå¾Œã®å¤‰åŒ–",
        "ä»Šã®å¹¸ã›",
        "ã‚ãªãŸã‚‚å¤‰ã‚ã‚Œã‚‹",
        "è¡Œå‹•ã™ã‚Œã°å¤‰ã‚ã‚‹",
        "æ±ºã‚ã‚‹ã®ã¯ã‚ãªãŸ",
    ],
    "N": [
        "å˜˜ã¯ã¤ãã¾ã›ã‚“",
        "å…¨éƒ¨å®Ÿä½“é¨“ã§ã™",
        "å¤±æ•—ã‚‚å…¨éƒ¨è©±ã—ã¾ã™",
        "å®Œç’§ã˜ã‚ƒãªã„",
        "ã ã‹ã‚‰ä¿¡ã˜ã¦ã»ã—ã„",
        "ã‚ãªãŸã¨åŒã˜æ‚©ã¿ãŒã‚ã£ãŸ",
        "ä¹—ã‚Šè¶ŠãˆãŸæ–¹æ³•ã‚’å…¨éƒ¨ã‚·ã‚§ã‚¢",
        "ä¸€ç·’ã«å¤‰ã‚ã‚Šã¾ã—ã‚‡ã†",
        "è³ªå•ã‚ã‚Œã°DMãã ã•ã„",
        "ã‚ãªãŸã®åŠ›ã«ãªã‚ŠãŸã„",
    ],
    "O": [
        "æ¯æ—¥å¹¸ã›ã‚’æ„Ÿã˜ã‚‹é–¢ä¿‚",
        "æœèµ·ããŸæ™‚ã®å®‰å¿ƒæ„Ÿ",
        "å½¼å¥³ã®ç¬‘é¡”ãŒè¦‹ã‚‰ã‚Œã‚‹",
        "ä¼šè©±ãŒæ¥½ã—ã„",
        "ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—ãŒè‡ªç„¶",
        "ãŠäº’ã„ã‚’å°Šé‡",
        "å­è‚²ã¦ã‚‚æ¥½ã—ã„",
        "ä»•äº‹ã‚‚é ‘å¼µã‚Œã‚‹",
        "äººç”ŸãŒå……å®Ÿ",
        "ã“ã‚ŒãŒæ‰‹ã«å…¥ã‚Šã¾ã™",
    ],
    "P": [
        "2é€±é–“Hã—ãªã„ã ã‘ã§è·é›¢ã‚’æ„Ÿã˜ãŸ",
        "å½¼å¥³ã¨ã®ä¼šè©±ã‚‚æ¸›ã‚‹",
        "è‡ªä¿¡ãŒãªããªã‚‹",
        "ã“ã®ã¾ã¾ã§ã„ã„ã®ã‹",
        "åˆ¥ã‚Œã‚‚è€ƒãˆãŸ",
        "ã§ã‚‚å­ä¾›ã®ãŸã‚ã«",
        "ä½•ã¨ã‹ã—ãŸã‹ã£ãŸ",
        "ã‚ãªãŸã‚‚åŒã˜ã§ã™ã‹?",
        "å¤‰ãˆã‚‰ã‚Œã¾ã™",
        "çµ¶å¯¾ã«",
    ],
    "Q": [
        "å¿™ã—ãã¦æ™‚é–“ãŒãªã„",
        "ä½•ã‹ã‚‰å§‹ã‚ã‚Œã°ã„ã„ã‹ã‚ã‹ã‚‰ãªã„",
        "å½¼å¥³ã«æ‹’å¦ã•ã‚Œã‚‹",
        "èª˜ã„æ–¹ãŒã‚ã‹ã‚‰ãªã„",
        "è‡ªä¿¡ãŒãªã„",
        "ç–²ã‚Œã¦ã‚‹",
        "å­ä¾›ãŒã„ã¦é›£ã—ã„",
        "å½¼å¥³ã®æ°—æŒã¡ãŒã‚ã‹ã‚‰ãªã„",
        "ã‚‚ã†æ‰‹é…ã‚Œã‹ã‚‚",
        "ã§ã‚‚è«¦ã‚ãŸããªã„",
    ],
    "R": [
        "å®Ÿã¯åŸå› ã¯æ˜ç¢º",
        "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³",
        "å®¶äº‹ã®ä¸å¹³ç­‰",
        "é£Ÿç”Ÿæ´»ã®ä¹±ã‚Œ",
        "ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—ã®æ¸›å°‘",
        "ãŠäº’ã„ã¸ã®é…æ…®ä¸è¶³",
        "æ™‚é–“ã®ä½¿ã„æ–¹",
        "å„ªå…ˆé †ä½ã®å•é¡Œ",
        "åŸå› ã‚’ç‰¹å®šã—ãªã„ã¨è§£æ±ºã—ãªã„",
        "ã‚ãªãŸã®åŸå› ã¯?",
    ],
    "S": [
        "å½¼å¥³ãŒæ±‚ã‚ã¦ã‚‹ã®ã¯ã€‡ã€‡",
        "ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã˜ã‚ƒãªã„",
        "æ°—æŒã¡ãŒå¤§äº‹",
        "å®‰å¿ƒæ„ŸãŒæ¬²ã—ã„",
        "å¤§åˆ‡ã«ã•ã‚Œã¦ã‚‹å®Ÿæ„Ÿ",
        "æ—¥å¸¸ã®ç©ã¿é‡ã­",
        "ã„ããªã‚Šã¯ãƒ€ãƒ¡",
        "æ®µéšãŒå¿…è¦",
        "å¥³æ€§å¿ƒç†ã‚’ç†è§£ã™ã‚‹",
        "ã“ã‚ŒãŒæœ€é‡è¦",
    ],
    "T": [
        "ã„ããªã‚Šèª˜ã†",
        "å®¶äº‹ã‚’æ‰‹ä¼ã‚ãªã„",
        "å½¼å¥³ã®è©±ã‚’èã‹ãªã„",
        "æ„Ÿè¬ã‚’ä¼ãˆãªã„",
        "ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—ãŒãªã„",
        "ä¸­é€”åŠç«¯ãªæ…‹åº¦",
        "è‡ªåˆ†å‹æ‰‹",
        "é£Ÿç”Ÿæ´»ãŒä¹±ã‚Œã¦ã‚‹",
        "åŸå› ã‚’ç†è§£ã—ã¦ãªã„",
        "ã“ã‚Œå…¨éƒ¨ã‚„ã£ã¦ã¾ã—ãŸ",
    ],
    "U": [
        "æ€ã‚ã›ã¶ã‚Šäº‹ä»¶",
        "ã„ããªã‚Šèª˜ã£ã¦æ‹’å¦",
        "å®¶äº‹ã§æ‰ã‚ãŸ",
        "ç„¡æ°—åŠ›ã§ä½•ã‚‚ã§ããªã‹ã£ãŸ",
        "å½¼å¥³ã®æ°—æŒã¡ç„¡è¦–ã—ã¦ãŸ",
        "è‡ªåˆ†å‹æ‰‹ã ã£ãŸ",
        "åçœ",
        "æ”¹å–„",
        "ä»Šã¯é•ã†",
        "å¤±æ•—ã‹ã‚‰å­¦ã‚“ã ",
    ],
    "V": [
        "ã“ã®ã¾ã¾ã˜ã‚ƒãƒ€ãƒ¡ã ã¨æ€ã£ãŸ",
        "å½¼å¥³ã®æ¶™ã‚’è¦‹ã¦",
        "å­ä¾›ã®ãŸã‚ã«",
        "è‡ªåˆ†ã®ãŸã‚ã«",
        "äººç”Ÿå¤‰ãˆãŸã‹ã£ãŸ",
        "æƒ…å ±ã‚’é›†ã‚ãŸ",
        "å®Ÿè·µã—ãŸ",
        "2é€±é–“ã§å¤‰åŒ–",
        "ä»ŠãŒã‚ã‚‹",
        "ã‚ãªãŸã‚‚å¤‰ã‚ã‚Œã‚‹",
    ],
    "W": [
        "ã‚¸ãƒ£ãƒ³ã‚¯ãƒ•ãƒ¼ãƒ‰ã‚’ã‚„ã‚ã‚‹",
        "å’Œé£Ÿä¸­å¿ƒã«ã™ã‚‹",
        "1é€±é–“ãƒ¡ãƒ‹ãƒ¥ãƒ¼å…¬é–‹",
        "ã‚³ãƒ³ãƒ“ãƒ‹é¸ã³ã®ã‚³ãƒ„",
        "ç°¡å˜ãƒ¬ã‚·ãƒ”",
        "æ°—åŠ›ãŒæˆ»ã‚‹é£Ÿäº‹",
        "ãƒ‰ãƒ¼ãƒ‘ãƒŸãƒ³ç®¡ç†",
        "ä½“åŠ›ã‚¢ãƒƒãƒ—",
        "æŒç¶šåŠ›å‘ä¸Š",
        "ã¾ãšã¯ã“ã“ã‹ã‚‰",
    ],
    "X": [
        "Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æ´»ç”¨",
        "å¯è¦–åŒ–ã®æ–¹æ³•",
        "å®¶äº‹ãƒªã‚¹ãƒˆä½œæˆ",
        "åˆ†æ‹…ã®æ±ºã‚æ–¹",
        "å¹³ç­‰ã®åŸºæº–",
        "ãŠäº’ã„ã®ç´å¾—",
        "æ„Ÿè¬ã®ç¿’æ…£",
        "è¦‹ç›´ã—ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°",
        "æŸ”è»Ÿã«å¯¾å¿œ",
        "ã“ã‚Œã§é–¢ä¿‚æ”¹å–„",
    ],
    "Y": [
        "ä¼šè©±ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ",
        "æ„Ÿè¬ã®ä¼ãˆæ–¹",
        "å½¼å¥³ã®è©±ã®èãæ–¹",
        "å…±æ„Ÿã®ç¤ºã—æ–¹",
        "å¯ã‚‹å‰ã®10åˆ†ä¼šè©±",
        "æœã®æŒ¨æ‹¶",
        "å¸°å®…å¾Œã®å£°ã‹ã‘",
        "äº›ç´°ãªæ°—é£ã„",
        "è¨€è‘‰ã®é¸ã³æ–¹",
        "ã“ã‚Œã ã‘ã§å¤‰ã‚ã‚‹",
    ],
    "Z": [
        "æ‰‹ã‚’ã¤ãªãã¨ã“ã‚ã‹ã‚‰",
        "ãƒã‚°ã®ç¿’æ…£",
        "è‡ªç„¶ãªãƒœãƒ‡ã‚£ã‚¿ãƒƒãƒ",
        "æ®µéšçš„ã«",
        "ç„¡ç†ã—ãªã„",
        "ãŠäº’ã„ã®ãƒšãƒ¼ã‚¹",
        "æ—¥å¸¸ã«æº¶ã‘è¾¼ã¾ã›ã‚‹",
        "ç‰¹åˆ¥ã˜ã‚ƒãªãã¦ã„ã„",
        "ç¶™ç¶šãŒå¤§äº‹",
        "å°‘ã—ãšã¤",
    ],
    "AA": [
        "ã„ããªã‚Šã¯NG",
        "é›°å›²æ°—ä½œã‚Šã‹ã‚‰",
        "å½¼å¥³ã®æ°—æŒã¡ã‚’ç¢ºèª",
        "ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹ã‚‹",
        "è¨€è‘‰ã®é¸ã³æ–¹",
        "è‡ªç„¶ãªæµã‚Œ",
        "æ‹’å¦ã•ã‚ŒãŸã‚‰",
        "æ¬¡ã«æ´»ã‹ã™",
        "ç„¦ã‚‰ãªã„",
        "ã“ã‚ŒãŒæ­£è§£",
    ],
    "BB": [
        "15åˆ†ã§æº€è¶³ã™ã‚‹æ–¹æ³•",
        "æº–å‚™ãŒ9å‰²",
        "ãŠäº’ã„ã®æ°—æŒã¡ç¢ºèª",
        "æœã®æ™‚é–“æ´»ç”¨",
        "åŠ¹ç‡ã‚ˆã‚Šè³ª",
        "ã‚¹ã‚­ãƒæ™‚é–“ã®ä½¿ã„æ–¹",
        "å­ä¾›ãŒå¯ãŸå¾Œ",
        "ç–²ã‚Œã¦ã‚‹æ™‚ã“ã",
        "çŸ­ãã¦ã‚‚æº€è¶³",
        "å®Ÿè·µæ–¹æ³•",
    ],
    "CC": [
        "å®Œç’§ã˜ã‚ƒãªãã¦ã„ã„",
        "å°ã•ãªä¸€æ­©ã‹ã‚‰",
        "ç¶™ç¶šãŒåŠ›",
        "å¤±æ•—ã—ã¦ã‚‚ã„ã„",
        "ãŠäº’ã„ã®å¹¸ã›ã®ãŸã‚",
        "ç¾©å‹™ã˜ã‚ƒãªã„",
        "æ¥½ã—ã‚€æ°—æŒã¡",
        "è‡ªä¿¡ã¯å¾Œã‹ã‚‰",
        "ç„¦ã‚‰ãªã„",
        "ã‚ãªãŸãªã‚‰ã§ãã‚‹",
    ],
    "DD": [
        "ç„¡æ–™æƒ…å ±ã¨ã®é•ã„",
        "ä½“ç³»çš„ã«ã¾ã¨ã¾ã£ã¦ã‚‹",
        "å…·ä½“çš„ãªã‚¹ãƒ†ãƒƒãƒ—",
        "å¤±æ•—ã‚’é¿ã‘ã‚‰ã‚Œã‚‹",
        "æ™‚é–“ã‚’è²·ãˆã‚‹",
        "å®Ÿç¸¾è€…ã®ãƒã‚¦ãƒã‚¦",
        "ã‚µãƒãƒ¼ãƒˆä»˜ã",
        "Â¥980ã§äººç”Ÿå¤‰ã‚ã‚‹",
        "æŠ•è³‡ã™ã‚‹ä¾¡å€¤",
        "ä»Šã™ãè¡Œå‹•",
    ],
    "EE": [
        "ä»Šæ—¥ã‹ã‚‰å¤‰ãˆã‚‰ã‚Œã‚‹",
        "ã¾ãš3ã¤ã‚„ã£ã¦",
        "ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯",
        "noteã§å…¨å…¬é–‹",
        "é™å®šç‰¹å…¸ã‚ã‚Š",
        "è¡Œå‹•ã—ãªã„ã¨å¤‰ã‚ã‚‰ãªã„",
        "1ãƒ¶æœˆå¾Œã®è‡ªåˆ†",
        "å¤‰ã‚ã‚‹ã®ã¯ã‚ãªãŸæ¬¡ç¬¬",
        "ä¸€ç·’ã«é ‘å¼µã‚ã†",
        "å¾…ã£ã¦ã¾ã™",
    ],
}


class ThreadsRelationshipPostGenerator:
    """å¤«å©¦é–¢ä¿‚ãƒ»åŒæ£²ã‚«ãƒƒãƒ—ãƒ«å‘ã‘ThreadsæŠ•ç¨¿ç”Ÿæˆã‚¯ãƒ©ã‚¹"""

    def __init__(self):
        self.emojis_soft = [
            "ğŸ’‘", "ğŸ’•", "âœ¨", "ğŸŒŸ", "ğŸ’«", "ğŸ™", "ğŸ”¥", "ğŸ’ª", "ğŸ‘", "ğŸ¯"
        ]
        self.emojis_direct = [
            "â¤ï¸", "ğŸ’–", "ğŸ’—", "ğŸ”¥", "âœ…", "â­•", "ğŸ’¯", "ğŸ‰", "ğŸš€", "ğŸ’¡"
        ]
        self.cta_phrases = [
            "è©³ã—ãã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã¸",
            "noteã§å…¨éƒ¨è©±ã—ã¦ã¾ã™",
            "ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‹ã‚‰è¦‹ã‚Œã¾ã™",
            "ç¶šãã¯noteã§",
            "ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯",
        ]

    def get_expression_level(self, day: int) -> str:
        """æ—¥æ•°ã«å¿œã˜ãŸè¡¨ç¾ãƒ¬ãƒ™ãƒ«ã‚’è¿”ã™"""
        if 1 <= day <= 14:
            return "soft"  # ã‚½ãƒ•ãƒˆè¡¨ç¾
        elif 15 <= day <= 30:
            return "direct"  # ç›´æ¥çš„ã ãŒå“ã‚ˆã
        else:
            return "moderate"  # å…·ä½“çš„ã™ããªã„

    def select_emojis(self, level: str, count: int = 2) -> List[str]:
        """è¡¨ç¾ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸçµµæ–‡å­—ã‚’é¸æŠ"""
        if level == "soft":
            return random.sample(
                self.emojis_soft, min(count, len(self.emojis_soft))
            )
        else:
            return random.sample(
                self.emojis_direct, min(count, len(self.emojis_direct))
            )

    def generate_post_type_a(self, theme: str, level: str) -> str:
        """ãƒ‘ã‚¿ãƒ¼ãƒ³A: å•é¡Œæèµ·å‹"""
        emojis = self.select_emojis(level, 2)
        cta = random.choice(self.cta_phrases)

        templates = [
            f"{theme}\n\nã“ã‚Œã€å®Ÿã¯åƒ•ã‚‚çµŒé¨“æ¸ˆã¿\n\nåŸå› ã¯3ã¤\nâœ“ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³\nâœ“ å®¶äº‹ã®ä¸å¹³ç­‰\nâœ“ é£Ÿç”Ÿæ´»ã®ä¹±ã‚Œ\n\næ”¹å–„ã—ãŸã‚‰2é€±é–“ã§å¾©æ´» {emojis[0]}\n\n{cta}",
            f"{theme}\n\nå¤šãã®äººãŒè¦‹è½ã¨ã—ã¦ã‚‹\n\nã§ã‚‚å®Ÿã¯è¶…é‡è¦\nâœ“ æ—¥å¸¸ã®ç©ã¿é‡ã­\nâœ“ å°ã•ãªæ°—é£ã„\nâœ“ ãŠäº’ã„ã¸ã®æ„Ÿè¬\n\nã“ã‚Œã ã‘ã§å¤‰ã‚ã‚‹ {emojis[0]}\n\n{cta}",
            f"{theme}\n\nã‚ãªãŸã‚‚åŒã˜ã§ã™ã‹?\n\nåƒ•ã¯\nãƒ»å®Œå…¨ã«è¦‹è½ã¨ã—ã¦ãŸ\nãƒ»æ°—ã¥ã„ã¦å³æ”¹å–„\nãƒ»2é€±é–“ã§åŠ¹æœå®Ÿæ„Ÿ\n\nä»Šã¯æ¯æ—¥å¹¸ã› {emojis[0]}\n\n{cta}",
        ]
        return random.choice(templates)

    def generate_post_type_b(self, theme: str, level: str) -> str:
        """ãƒ‘ã‚¿ãƒ¼ãƒ³B: ä½“é¨“è«‡å‹"""
        emojis = self.select_emojis(level, 2)
        cta = random.choice(self.cta_phrases)

        templates = [
            f"{theme}\n\nBefore:\nãƒ»é€±1â†’æœˆ2å›ã«æ¸›å°‘\nãƒ»ä¼šè©±ã‚‚æ¸›ã£ãŸ\nãƒ»ç„¡æ°—åŠ›\n\nAfter:\nãƒ»å¹´é–“130å›\nãƒ»æ¯æ—¥å¹¸ã›\nãƒ»æ°—åŠ›å……å®Ÿ\n\nå¤‰ãˆãŸã®ã¯3ã¤ã ã‘ {emojis[0]}\n\n{cta}",
            f"{theme}\n\næ­£ç›´ã«è¨€ã„ã¾ã™\n\næ˜”ã¯\nãƒ»å…¨ç„¶ãƒ€ãƒ¡ã ã£ãŸ\nãƒ»æ‚©ã‚“ã§ãŸ\nãƒ»è«¦ã‚ã‹ã‘ãŸ\n\nä»Šã¯\nãƒ»æ¯æ—¥å¹¸ã›\nãƒ»å½¼å¥³ã‚‚æº€è¶³\nãƒ»é–¢ä¿‚è‰¯å¥½ {emojis[0]}\n\n{cta}",
            f"{theme}\n\nå®Ÿä½“é¨“ã‚’è©±ã—ã¾ã™\n\næœ€åˆ:\nãƒ»ä½•ã‚‚çŸ¥ã‚‰ãªã‹ã£ãŸ\nãƒ»å¤±æ•—ã°ã‹ã‚Š\n\nä»Š:\nãƒ»ç†è§£ã§ããŸ\nãƒ»å®Ÿè·µã§ããŸ\nãƒ»çµæœå‡ºãŸ {emojis[0]}\n\n{cta}",
        ]
        return random.choice(templates)

    def generate_post_type_c(self, theme: str, level: str) -> str:
        """ãƒ‘ã‚¿ãƒ¼ãƒ³C: ãƒªã‚¹ãƒˆå‹"""
        emojis = self.select_emojis(level, 2)
        cta = random.choice(self.cta_phrases)

        templates = [
            f"{theme}\n\nãƒ—ãƒãƒ¬ã‚¹ã‹ã‚‰å¾©æ´»ã™ã‚‹æ–¹æ³•5é¸\n\nâœ“ é£Ÿäº‹ã‚’å’Œé£Ÿä¸­å¿ƒã«\nâœ“ å®¶äº‹ã‚’å¯è¦–åŒ–\nâœ“ å¯ã‚‹å‰10åˆ†ä¼šè©±\nâœ“ å°ã•ãªã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—\nâœ“ æŠ¼ã—å¼•ãã‚’æ„è­˜\n\nä¿å­˜ã—ã¦å¾Œã§è¦‹è¿”ã—ã¦ã­ {emojis[0]}\n\n{cta}",
            f"{theme}\n\nçµ¶å¯¾ã‚„ã‚‹ã¹ã3ã¤\n\n1. ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³(æ¯æ—¥)\n2. å®¶äº‹ã®è¦‹ãˆã‚‹åŒ–(æ„Ÿè¬ãŒç”Ÿã¾ã‚Œã‚‹)\n3. é£Ÿç”Ÿæ´»æ”¹å–„(æ°—åŠ›å›å¾©)\n\nã“ã‚Œã§äººç”Ÿå¤‰ã‚ã‚‹ {emojis[0]}\n\n{cta}",
            f"{theme}\n\nã‚„ã£ã¦ã‚ˆã‹ã£ãŸã“ã¨\n\nâ‘  å½¼å¥³ã®è©±ã‚’èã\nâ‘¡ æ„Ÿè¬ã‚’è¨€è‘‰ã«ã™ã‚‹\nâ‘¢ ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—\nâ‘£ æ™‚çŸ­ã§ã‚‚è³ªé‡è¦–\nâ‘¤ å®Œç’§ç›®æŒ‡ã•ãªã„\n\nã‚ãªãŸã‚‚ã§ãã‚‹ {emojis[0]}\n\n{cta}",
        ]
        return random.choice(templates)

    def generate_post(
        self,
        category: str,
        theme: str,
        post_type: str = "random",
        day: int = 1,
    ) -> Dict:
        """æŠ•ç¨¿ã‚’ç”Ÿæˆ"""
        level = self.get_expression_level(day)

        if post_type == "random":
            post_type = random.choice(["A", "B", "C"])

        if post_type == "A":
            content = self.generate_post_type_a(theme, level)
        elif post_type == "B":
            content = self.generate_post_type_b(theme, level)
        else:
            content = self.generate_post_type_c(theme, level)

        return {
            "category": category,
            "theme": theme,
            "type": post_type,
            "content": content,
            "level": level,
            "phase": CATEGORIES[category]["phase"],
            "day": day,
            "char_count": len(content),
        }

    def generate_category_posts(
        self, category: str, count: int = 10, day: int = 1
    ) -> List[Dict[str, str]]:
        """ã‚«ãƒ†ã‚´ãƒªã®æŠ•ç¨¿ã‚’è¤‡æ•°ç”Ÿæˆ"""
        themes = THEMES.get(category, [])
        if not themes:
            raise ValueError(f"Invalid category: {category}")

        posts = []
        for i, theme in enumerate(themes[:count]):
            post = self.generate_post(category, theme, day=day)
            posts.append(post)

        return posts

    def generate_week_schedule(self, week: int = 1) -> List[Dict[str, str]]:
        """é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”Ÿæˆ(1æ—¥10æŠ•ç¨¿ Ã— 7æ—¥ = 70æŠ•ç¨¿)"""
        if week == 1:
            # Week 1: ä¿¡ç”¨æ•™è‚²ãƒ•ã‚§ãƒ¼ã‚º1 (ã‚«ãƒ†ã‚´ãƒªA-G)
            categories = ["A", "B", "C", "D", "E", "F", "G"]
            day_start = 1
        elif week == 2:
            # Week 2: ä¿¡ç”¨æ•™è‚²ãƒ•ã‚§ãƒ¼ã‚º2 (ã‚«ãƒ†ã‚´ãƒªH-N)
            categories = ["H", "I", "J", "K", "L", "M", "N"]
            day_start = 8
        elif week == 3:
            # Week 3: ç›®çš„+å•é¡Œæ•™è‚² (ã‚«ãƒ†ã‚´ãƒªO-V)
            categories = ["O", "P", "Q", "R", "S", "T", "U", "V"][:7]
            day_start = 15
        elif week == 4:
            # Week 4: æ‰‹æ®µæ•™è‚² (ã‚«ãƒ†ã‚´ãƒªW-CC)
            categories = ["W", "X", "Y", "Z", "AA", "BB", "CC"]
            day_start = 22
        else:
            raise ValueError("Week must be 1-4")

        all_posts = []
        for day_offset in range(7):
            day = day_start + day_offset
            daily_posts = []

            for cat in categories:
                themes = THEMES.get(cat, [])
                if themes:
                    theme = random.choice(themes)
                    post = self.generate_post(cat, theme, day=day)
                    daily_posts.append(post)

            # 1æ—¥10æŠ•ç¨¿ã«ãªã‚‹ã‚ˆã†èª¿æ•´
            while len(daily_posts) < 10:
                cat = random.choice(categories)
                themes = THEMES.get(cat, [])
                if themes:
                    theme = random.choice(themes)
                    post = self.generate_post(cat, theme, day=day)
                    daily_posts.append(post)

            all_posts.extend(daily_posts[:10])

        return all_posts

    def export_to_csv(self, posts: List[Dict[str, str]], filename: str):
        """CSVå‡ºåŠ›"""
        with open(filename, "w", newline="", encoding="utf-8") as f:
            writer = csv.DictWriter(
                f,
                fieldnames=[
                    "day",
                    "category",
                    "phase",
                    "theme",
                    "type",
                    "level",
                    "content",
                    "char_count",
                ],
            )
            writer.writeheader()
            writer.writerows(posts)

        print(f"âœ… {len(posts)}æŠ•ç¨¿ã‚’CSVå‡ºåŠ›: {filename}")


def interactive_mode():
    """å¯¾è©±ãƒ¢ãƒ¼ãƒ‰"""
    generator = ThreadsRelationshipPostGenerator()

    print("\n" + "=" * 60)
    print("ğŸ¯ Threads Relationship Post Generator")
    print("=" * 60)
    print("\nã€ãƒ¢ãƒ¼ãƒ‰é¸æŠã€‘")
    print("1. ã‚«ãƒ†ã‚´ãƒªæŒ‡å®šç”Ÿæˆ")
    print("2. é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”Ÿæˆ (70æŠ•ç¨¿)")
    print("3. ã‚«ãƒ†ã‚´ãƒªä¸€è¦§è¡¨ç¤º")
    print("0. çµ‚äº†")

    while True:
        choice = input("\né¸æŠã—ã¦ãã ã•ã„ (0-3): ").strip()

        if choice == "0":
            print("\nğŸ‘‹ çµ‚äº†ã—ã¾ã™")
            break

        elif choice == "1":
            print("\nã€ã‚«ãƒ†ã‚´ãƒªæŒ‡å®šç”Ÿæˆã€‘")
            print("ã‚«ãƒ†ã‚´ãƒªä¾‹: A, B, C, ..., EE")
            category = input("ã‚«ãƒ†ã‚´ãƒªã‚’å…¥åŠ›: ").strip().upper()

            if category not in CATEGORIES:
                print(f"âŒ ç„¡åŠ¹ãªã‚«ãƒ†ã‚´ãƒª: {category}")
                continue

            count = int(input("ç”Ÿæˆæ•° (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10): ").strip() or "10")
            day = int(input("æ—¥æ•° (1-30): ").strip() or "1")

            posts = generator.generate_category_posts(category, count, day)

            print(f"\nâœ… {len(posts)}æŠ•ç¨¿ã‚’ç”Ÿæˆã—ã¾ã—ãŸ\n")
            for i, post in enumerate(posts, 1):
                print(f"ã€æŠ•ç¨¿ {i}ã€‘")
                print(f"ã‚«ãƒ†ã‚´ãƒª: {post['category']} ({post['phase']})")
                print(f"ãƒ†ãƒ¼ãƒ: {post['theme']}")
                print(f"ã‚¿ã‚¤ãƒ—: {post['type']} | ãƒ¬ãƒ™ãƒ«: {post['level']}")
                print(f"æ–‡å­—æ•°: {post['char_count']}")
                print("\n" + post["content"])
                print("\n" + "-" * 60 + "\n")

            save = input("CSVä¿å­˜ã—ã¾ã™ã‹? (y/n): ").strip().lower()
            if save == "y":
                filename = f"relationship_cat{category}_day{day}.csv"
                generator.export_to_csv(posts, filename)

        elif choice == "2":
            print("\nã€é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”Ÿæˆã€‘")
            week = int(input("é€±ã‚’é¸æŠ (1-4): ").strip())

            if week not in [1, 2, 3, 4]:
                print("âŒ 1-4ã®é€±ã‚’é¸æŠã—ã¦ãã ã•ã„")
                continue

            posts = generator.generate_week_schedule(week)

            print(f"\nâœ… Week {week}: {len(posts)}æŠ•ç¨¿ã‚’ç”Ÿæˆã—ã¾ã—ãŸ\n")

            # æ—¥åˆ¥ã‚µãƒãƒªãƒ¼
            day_summary = {}
            for post in posts:
                day = post["day"]
                day_summary[day] = day_summary.get(day, 0) + 1

            for day, count in sorted(day_summary.items()):
                print(f"Day {day}: {count}æŠ•ç¨¿")

            print("\n" + "-" * 60 + "\n")

            # æœ€åˆã®3æŠ•ç¨¿ã‚’è¡¨ç¤º
            for i, post in enumerate(posts[:3], 1):
                print(f"ã€ã‚µãƒ³ãƒ—ãƒ«æŠ•ç¨¿ {i}ã€‘")
                print(f"Day {post['day']} | {post['category']} ({post['phase']})")
                print(f"ãƒ†ãƒ¼ãƒ: {post['theme']}")
                print("\n" + post["content"])
                print("\n" + "-" * 60 + "\n")

            save = input("CSVä¿å­˜ã—ã¾ã™ã‹? (y/n): ").strip().lower()
            if save == "y":
                filename = f"relationship_week{week}.csv"
                generator.export_to_csv(posts, filename)

        elif choice == "3":
            print("\nã€ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã€‘")
            print("-" * 60)
            for cat, info in CATEGORIES.items():
                print(
                    f"{cat:3s} | {info['name']:20s} | {info['phase']:6s} | Day {info['days']}"
                )
            print("-" * 60)


def main():
    parser = argparse.ArgumentParser(
        description="Threads Relationship Post Generator"
    )
    parser.add_argument(
        "--category", type=str, help="ã‚«ãƒ†ã‚´ãƒªæŒ‡å®š (A, B, C, ..., EE)"
    )
    parser.add_argument("--count", type=int, default=10, help="ç”Ÿæˆæ•°")
    parser.add_argument("--week", type=int, help="é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« (1-4)")
    parser.add_argument("--day", type=int, default=1, help="æ—¥æ•° (1-30)")
    parser.add_argument("--output", type=str, help="CSVå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å")
    parser.add_argument("--list", action="store_true", help="ã‚«ãƒ†ã‚´ãƒªä¸€è¦§è¡¨ç¤º")

    args = parser.parse_args()

    generator = ThreadsRelationshipPostGenerator()

    if args.list:
        print("\nã€ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã€‘")
        print("-" * 60)
        for cat, info in CATEGORIES.items():
            print(
                f"{cat:3s} | {info['name']:20s} | {info['phase']:6s} | Day {info['days']}"
            )
        print("-" * 60)
        return

    if args.category:
        posts = generator.generate_category_posts(args.category, args.count, args.day)
        for post in posts:
            print("\n" + "=" * 60)
            print(post["content"])
            print("=" * 60)

        if args.output:
            generator.export_to_csv(posts, args.output)

    elif args.week:
        posts = generator.generate_week_schedule(args.week)
        print(f"\nâœ… Week {args.week}: {len(posts)}æŠ•ç¨¿ã‚’ç”Ÿæˆã—ã¾ã—ãŸ")

        if args.output:
            generator.export_to_csv(posts, args.output)
        else:
            for i, post in enumerate(posts[:5], 1):
                print(f"\nã€ã‚µãƒ³ãƒ—ãƒ« {i}ã€‘Day {post['day']}")
                print(post["content"])

    else:
        interactive_mode()


if __name__ == "__main__":
    main()
